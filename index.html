<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order Up!</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
  <style>
    :root{--bg:#1a0a12;--card:#2a1020;--card2:#331525;--border:#5a2040;--pink:#ff69b4;--pink2:#ff1493;--pink-light:#ffb6d9;--pink-glow:rgba(255,105,180,0.15);--green:#a8ff78;--red:#ff6b6b;--text:#ffe0f0;--muted:#c080a0;}
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;}
    body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;background:radial-gradient(ellipse at 20% 20%,rgba(255,20,147,0.07) 0%,transparent 50%),radial-gradient(ellipse at 80% 80%,rgba(255,105,180,0.05) 0%,transparent 50%),linear-gradient(rgba(255,105,180,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(255,105,180,0.02) 1px,transparent 1px);background-size:100% 100%,100% 100%,44px 44px,44px 44px;}
    .page{position:relative;z-index:1;}
    .hidden{display:none!important;}
    ::-webkit-scrollbar{width:5px;}
    ::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px;}

    #version-banner{position:fixed;top:14px;right:14px;z-index:10000;background:linear-gradient(135deg,var(--pink),var(--pink2));color:#fff;font-size:12px;font-weight:700;letter-spacing:1px;padding:7px 14px;border-radius:22px;box-shadow:0 4px 20px rgba(255,20,147,0.45);display:flex;align-items:center;gap:8px;cursor:pointer;transition:opacity .35s,transform .35s;animation:vbIn .7s cubic-bezier(.34,1.56,.64,1) both;}
    #version-banner.gone{opacity:0;transform:translateY(-10px);pointer-events:none;}
    @keyframes vbIn{from{opacity:0;transform:translateY(-16px);}to{opacity:1;transform:translateY(0);}}
    .vb-dot{width:7px;height:7px;border-radius:50%;background:rgba(255,255,255,0.9);flex-shrink:0;animation:vbPulse 1.4s infinite;}
    @keyframes vbPulse{0%,100%{opacity:1;transform:scale(1);}50%{opacity:.4;transform:scale(.7);}}
    .vb-x{opacity:.65;font-size:11px;margin-left:3px;}

    #landing{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center;}
    .logo{font-family:'Playfair Display',serif;font-weight:900;font-size:clamp(60px,13vw,110px);letter-spacing:-2px;line-height:0.95;margin-bottom:10px;background:linear-gradient(135deg,#ffb6d9,var(--pink),var(--pink2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;filter:drop-shadow(0 0 28px rgba(255,105,180,0.35));}
    .logo-sub{font-family:'Playfair Display',serif;font-size:clamp(14px,3vw,22px);color:var(--pink-light);letter-spacing:5px;text-transform:uppercase;margin-bottom:44px;opacity:0.75;}
    .role-cards{display:flex;gap:18px;flex-wrap:wrap;justify-content:center;}
    .role-card{background:var(--card);border:2px solid var(--border);border-radius:20px;padding:34px 44px;cursor:pointer;transition:all .22s;min-width:180px;text-align:center;position:relative;overflow:hidden;}
    .role-card::after{content:'';position:absolute;inset:0;background:var(--pink-glow);opacity:0;transition:opacity .22s;}
    .role-card:hover{border-color:var(--pink);transform:translateY(-5px);box-shadow:0 20px 48px rgba(255,20,147,0.18);}
    .role-card:hover::after{opacity:1;}
    .role-card .ico{font-size:42px;margin-bottom:12px;}
    .role-card h2{font-family:'Playfair Display',serif;font-size:22px;margin-bottom:6px;color:var(--pink-light);}
    .role-card p{color:var(--muted);font-size:12px;}
    .join-box{margin-top:28px;background:var(--card);border:2px solid var(--border);border-radius:16px;padding:22px 28px;display:flex;flex-direction:column;align-items:center;gap:12px;min-width:280px;}
    .join-box label{color:var(--muted);font-size:11px;letter-spacing:3px;text-transform:uppercase;}
    .join-row{display:flex;gap:8px;width:100%;}
    input[type=text]{background:#100010;border:2px solid var(--border);color:var(--text);padding:11px 15px;border-radius:10px;font-size:15px;font-family:'DM Sans',sans-serif;outline:none;transition:border-color .2s;}
    input[type=text]:focus{border-color:var(--pink);box-shadow:0 0 0 3px rgba(255,105,180,0.12);}
    .btn{padding:11px 22px;border:none;border-radius:10px;font-size:14px;font-family:'DM Sans',sans-serif;font-weight:700;cursor:pointer;transition:all .18s;}
    .btn-primary{background:linear-gradient(135deg,var(--pink),var(--pink2));color:#fff;box-shadow:0 4px 14px rgba(255,20,147,0.28);}
    .btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 22px rgba(255,20,147,0.42);filter:brightness(1.08);}
    .btn-primary:disabled{opacity:.4;cursor:not-allowed;transform:none;filter:none;}
    .btn-ghost{background:transparent;border:2px solid var(--border);color:var(--text);}
    .btn-ghost:hover{border-color:var(--pink);color:var(--pink);}
    .btn-outline{background:transparent;border:2px solid var(--pink);color:var(--pink);}
    .btn-outline:hover{background:var(--pink-glow);}
    .btn-random{background:linear-gradient(135deg,#a855f7,#ec4899);color:#fff;box-shadow:0 4px 14px rgba(168,85,247,0.35);display:flex;align-items:center;gap:7px;}
    .btn-random:hover{transform:translateY(-2px);box-shadow:0 8px 22px rgba(168,85,247,0.5);filter:brightness(1.1);}
    .btn-random.spinning .dice{animation:diceSpin 0.5s ease;}
    @keyframes diceSpin{0%{transform:rotate(0deg) scale(1);}50%{transform:rotate(180deg) scale(1.4);}100%{transform:rotate(360deg) scale(1);}}

    #name-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center;}
    #name-screen h2{font-family:'Playfair Display',serif;font-size:38px;color:var(--pink-light);margin-bottom:8px;}
    #name-screen p{color:var(--muted);margin-bottom:28px;}
    .name-form{display:flex;flex-direction:column;gap:11px;width:100%;max-width:290px;}
    .name-form input{text-align:center;font-size:18px;}

    #host-lobby{display:flex;flex-direction:column;align-items:center;min-height:100vh;padding:28px 20px;}
    .top-bar{width:100%;max-width:880px;display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;}
    .badge{background:linear-gradient(135deg,var(--pink),var(--pink2));color:#fff;font-size:12px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 13px;border-radius:20px;}
    .badge.player-badge{background:linear-gradient(135deg,#a855f7,#ec4899);}
    .room-code-block{text-align:center;margin-bottom:26px;}
    .room-code-block label{display:block;color:var(--muted);font-size:11px;letter-spacing:3px;text-transform:uppercase;margin-bottom:7px;}
    .room-code{font-family:'Playfair Display',serif;font-size:60px;letter-spacing:10px;color:var(--pink);line-height:1;text-shadow:0 0 28px rgba(255,105,180,0.35);}
    .lobby-grid{display:grid;grid-template-columns:1fr 1fr;gap:18px;width:100%;max-width:880px;}
    @media(max-width:640px){.lobby-grid{grid-template-columns:1fr;}}
    .panel{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:20px;}
    .panel h3{font-family:'Playfair Display',serif;font-size:16px;color:var(--pink-light);margin-bottom:13px;}
    #qr-wrap{display:flex;justify-content:center;margin-bottom:11px;}
    #qr-inner{background:#fff;padding:10px;border-radius:10px;display:inline-block;border:3px solid var(--pink);}
    .join-url{word-break:break-all;font-size:10px;color:var(--muted);text-align:center;background:#100010;padding:7px 10px;border-radius:6px;}
    .player-list{display:flex;flex-direction:column;gap:7px;min-height:48px;}
    .player-item{display:flex;align-items:center;gap:10px;background:var(--card2);border-radius:9px;padding:9px 13px;animation:slideIn .28s ease;}
    @keyframes slideIn{from{opacity:0;transform:translateX(-7px);}to{opacity:1;transform:translateX(0);}}
    .p-avatar{width:30px;height:30px;border-radius:50%;background:rgba(255,105,180,0.12);display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0;border:1px solid var(--border);}
    .p-name{font-weight:600;font-size:13px;flex:1;}
    .p-score{font-size:12px;color:var(--pink);font-weight:700;}
    .pulse-dot{width:7px;height:7px;border-radius:50%;background:var(--pink);animation:pdp 1.5s infinite;}
    @keyframes pdp{0%,100%{opacity:1;}50%{opacity:.2;}}
    .no-players{color:var(--muted);text-align:center;padding:20px;font-size:13px;}

    #host-pick-screen{display:flex;flex-direction:column;align-items:center;min-height:100vh;padding:24px 20px;}
    .pick-controls{display:flex;gap:9px;width:100%;max-width:900px;margin-bottom:11px;flex-wrap:wrap;align-items:center;}
    .pick-controls input{flex:1;min-width:200px;}
    .cat-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(195px,1fr));gap:9px;width:100%;max-width:900px;margin-bottom:18px;max-height:60vh;overflow-y:auto;padding:4px;}
    .cat-card{background:var(--card);border:2px solid var(--border);border-radius:11px;padding:13px 16px;cursor:pointer;transition:all .17s;}
    .cat-card:hover{border-color:var(--pink);background:var(--card2);transform:translateY(-2px);}
    .cat-card.selected{border-color:var(--pink2);background:rgba(255,20,147,0.1);box-shadow:0 0 14px rgba(255,20,147,0.18);}
    .cat-card.used{opacity:.3;cursor:not-allowed;pointer-events:none;}
    .cat-type{font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-bottom:4px;}
    .cat-name{font-family:'Playfair Display',serif;font-size:14px;color:var(--pink-light);margin-bottom:5px;}
    .cat-items{font-size:10px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .cat-card.flash{animation:catFlash .35s ease;}
    @keyframes catFlash{0%{transform:scale(1);}50%{transform:scale(1.04);box-shadow:0 0 24px rgba(255,20,147,0.5);}100%{transform:scale(1);}}

    .type-tabs{display:flex;gap:6px;flex-wrap:wrap;width:100%;max-width:900px;margin-bottom:10px;}
    .type-tab{background:var(--card);border:2px solid var(--border);border-radius:20px;padding:5px 13px;font-size:11px;font-weight:700;cursor:pointer;transition:all .15s;color:var(--muted);letter-spacing:.5px;}
    .type-tab:hover{border-color:var(--pink);color:var(--pink-light);}
    .type-tab.active{background:rgba(255,20,147,0.12);border-color:var(--pink);color:var(--pink-light);}

    .game-wrap{display:flex;flex-direction:column;align-items:center;min-height:100vh;padding:24px 20px;}
    .game-head{text-align:center;margin-bottom:14px;}
    .game-head h1{font-family:'Playfair Display',serif;font-size:26px;color:var(--pink-light);margin-bottom:3px;}
    .game-head p{color:var(--muted);font-size:12px;}
    .cat-label{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:5px 16px;font-size:12px;color:var(--pink-light);letter-spacing:.5px;margin-bottom:12px;}
    .locked-bar{background:rgba(255,20,147,0.07);border:1px solid var(--pink2);color:var(--pink-light);border-radius:9px;padding:9px 18px;font-size:12px;text-align:center;margin-bottom:12px;max-width:460px;width:100%;}
    .rank-labels{display:flex;justify-content:space-between;max-width:460px;width:100%;margin-bottom:6px;padding:0 2px;}
    .rl{font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;}
    .rl.top{color:var(--pink);}
    .rl.bot{color:var(--muted);}
    .round-badge{background:var(--card2);border:1px solid var(--border);border-radius:20px;padding:4px 12px;font-size:12px;color:var(--muted);}
    .tap-hint{font-size:11px;color:var(--muted);text-align:center;margin-bottom:10px;max-width:460px;width:100%;}
    .tap-hint b{color:var(--pink);}

    .rank-arena{display:flex;gap:12px;width:100%;max-width:460px;align-items:flex-start;}
    .rank-slots{display:flex;flex-direction:column;gap:5px;flex:1;min-width:0;}
    .rank-slot{display:flex;align-items:center;gap:9px;min-height:50px;background:var(--card);border:2px dashed var(--border);border-radius:11px;padding:9px 12px;transition:border-color .15s,background .15s;cursor:default;}
    .rank-slot.slot-ready{border-color:rgba(255,105,180,.5);border-style:dashed;background:rgba(255,20,147,.04);}
    .rank-slot.filled{border-style:solid;}
    .rank-slot.filled.slot-ready{border-color:var(--pink);}
    .slot-num{font-family:'Playfair Display',serif;font-size:19px;font-weight:700;width:22px;text-align:center;flex-shrink:0;}
    .slot-name{font-size:13px;font-weight:600;flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
    .slot-empty{font-size:11px;color:var(--muted);flex:1;font-style:italic;}
    .slot-remove{font-size:12px;color:var(--muted);cursor:pointer;padding:3px 5px;border-radius:4px;flex-shrink:0;transition:color .15s;}
    .slot-remove:hover{color:var(--red);}

    .item-pool{display:flex;flex-direction:column;gap:5px;width:130px;flex-shrink:0;}
    @media(max-width:400px){.item-pool{width:110px;}}
    .pool-label{font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);text-align:center;margin-bottom:3px;}
    .pool-item{background:var(--card2);border:2px solid var(--border);border-radius:9px;padding:8px 10px;font-size:12px;font-weight:600;cursor:pointer;transition:all .15s;text-align:center;line-height:1.25;word-break:break-word;}
    .pool-item:active{transform:scale(.97);}
    .pool-item:hover{border-color:var(--pink);background:rgba(255,105,180,.08);}
    .pool-item.sel{border-color:var(--pink2);background:rgba(255,20,147,.14);box-shadow:0 0 10px rgba(255,20,147,.22);}

    .slist{list-style:none;max-width:420px;width:100%;}
    .slist li{display:flex;align-items:center;gap:11px;padding:12px 14px;margin-bottom:6px;background:var(--card);border:2px solid var(--border);border-radius:11px;position:relative;overflow:hidden;}
    .slist li.correct{border-color:var(--green)!important;background:rgba(168,255,120,.07)!important;}
    .slist li.wrong{border-color:var(--red)!important;background:rgba(255,107,107,.07)!important;}
    .stripe{position:absolute;left:0;top:0;bottom:0;width:4px;}
    .rnum{font-family:'Playfair Display',serif;font-size:19px;font-weight:700;width:24px;text-align:center;flex-shrink:0;}
    .iname{font-size:14px;font-weight:600;flex:1;}
    .res-host-pos{font-size:10px;color:var(--muted);margin-left:auto;margin-right:4px;}
    .res-check{font-size:15px;}

    #waiting-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center;}
    .spinner{width:50px;height:50px;border:4px solid var(--border);border-top-color:var(--pink);border-radius:50%;animation:spin .85s linear infinite;margin-bottom:22px;}
    @keyframes spin{to{transform:rotate(360deg);}}

    #round-results-screen{display:flex;flex-direction:column;align-items:center;padding:32px 20px;min-height:100vh;}
    .rr-title{font-family:'Playfair Display',serif;font-size:40px;color:var(--pink-light);margin-bottom:3px;text-align:center;}
    .your-score-box{background:var(--card);border:2px solid var(--pink);border-radius:14px;padding:16px 32px;text-align:center;margin:14px 0;}
    .score-num{font-family:'Playfair Display',serif;font-size:52px;color:var(--pink);line-height:1;}
    .score-label{color:var(--muted);font-size:12px;margin-top:3px;}
    .result-section-title{color:var(--pink-light);font-size:13px;font-weight:700;margin-bottom:8px;text-align:center;}
    .lb{width:100%;max-width:480px;margin-top:10px;}
    .lb h3{font-family:'Playfair Display',serif;font-size:18px;color:var(--pink-light);margin-bottom:11px;text-align:center;}
    .lb-item{display:flex;align-items:center;gap:12px;background:var(--card);border:1px solid var(--border);border-radius:11px;padding:11px 15px;margin-bottom:7px;animation:slideIn .4s ease both;}
    .lb-pos{font-family:'Playfair Display',serif;font-size:22px;width:32px;text-align:center;}
    .lb-name{flex:1;font-weight:600;font-size:13px;}
    .lb-score{font-family:'Playfair Display',serif;font-size:20px;color:var(--pink);text-align:right;}
    .lb-sub{font-size:10px;color:var(--muted);}
    .bar-bg{height:4px;background:var(--border);border-radius:2px;margin-top:4px;}
    .bar{height:100%;border-radius:2px;background:linear-gradient(90deg,var(--pink),var(--pink2));transition:width 1s ease;}
    .divider{width:100%;max-width:480px;border:none;border-top:1px solid var(--border);margin:16px 0;}
    #final-results-screen{display:flex;flex-direction:column;align-items:center;padding:36px 20px;min-height:100vh;}
    .final-title{font-family:'Playfair Display',serif;font-size:52px;font-weight:900;color:var(--pink-light);text-align:center;text-shadow:0 0 36px rgba(255,105,180,.35);margin-bottom:4px;}
    .confetti-row{font-size:26px;letter-spacing:4px;margin-bottom:20px;}
    .winner-card{background:linear-gradient(135deg,rgba(255,105,180,.13),rgba(255,20,147,.08));border:2px solid var(--pink);border-radius:18px;padding:20px 36px;text-align:center;margin-bottom:24px;}
    .winner-card .crown{font-size:36px;}
    .winner-name{font-family:'Playfair Display',serif;font-size:30px;color:var(--pink-light);}
    .winner-pts{color:var(--muted);font-size:13px;margin-top:3px;}
    .sub-banner{background:rgba(168,255,120,.07);border:1px solid var(--green);color:var(--green);border-radius:9px;padding:12px 20px;font-size:13px;font-weight:600;text-align:center;margin-top:14px;max-width:420px;width:100%;}
    .pp-item{display:flex;align-items:center;gap:9px;background:var(--card2);border-radius:8px;padding:7px 13px;font-size:12px;margin-bottom:5px;}
    .pp-submitted{color:var(--green);font-size:11px;margin-left:auto;}
    .pp-waiting{color:var(--muted);font-size:11px;margin-left:auto;animation:pdp 2s infinite;}
    .total-pts{font-size:12px;color:var(--pink);font-weight:700;}
    .toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(100px);font-weight:700;padding:10px 22px;border-radius:30px;font-size:13px;transition:transform .4s cubic-bezier(.34,1.56,.64,1);z-index:9999;pointer-events:none;color:#fff;}
    .toast.show{transform:translateX(-50%) translateY(0);}
    #fb-status{position:fixed;top:0;left:0;right:0;padding:8px 20px;font-size:12px;font-weight:700;text-align:center;z-index:9998;display:none;}
    #fb-status.err{background:#c0392b;color:#fff;display:block;}
    #fb-status.ok{background:#27ae60;color:#fff;display:block;}

    .cat-count-badge{background:var(--card2);border:1px solid var(--border);border-radius:20px;padding:4px 12px;font-size:11px;color:var(--muted);margin-left:auto;}

    .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.72);z-index:5000;display:flex;align-items:center;justify-content:center;padding:20px;backdrop-filter:blur(4px);}
    .modal-overlay.hidden{display:none!important;}
    .modal-box{background:var(--card);border:2px solid var(--pink);border-radius:20px;padding:28px 28px 24px;width:100%;max-width:480px;max-height:90vh;overflow-y:auto;animation:modalIn .3s cubic-bezier(.34,1.56,.64,1);}
    @keyframes modalIn{from{opacity:0;transform:scale(.9) translateY(20px);}to{opacity:1;transform:scale(1) translateY(0);}}
    .modal-box h2{font-family:'Playfair Display',serif;font-size:24px;color:var(--pink-light);margin-bottom:5px;}
    .modal-box p{color:var(--muted);font-size:12px;margin-bottom:18px;}
    .modal-field{margin-bottom:13px;}
    .modal-field label{display:block;font-size:11px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-bottom:6px;}
    .modal-field input{width:100%;}
    .item-inputs{display:flex;flex-direction:column;gap:7px;}
    .item-input-row{display:flex;align-items:center;gap:8px;}
    .item-num{font-family:'Playfair Display',serif;font-size:16px;font-weight:700;width:20px;text-align:center;flex-shrink:0;color:var(--pink);}
    .item-input-row input{flex:1;}
    .modal-footer{display:flex;gap:10px;justify-content:flex-end;margin-top:20px;flex-wrap:wrap;}
    .custom-cat-card .cat-type{color:#c084fc!important;}
    .btn-purple{background:linear-gradient(135deg,#a855f7,#7c3aed);color:#fff;box-shadow:0 4px 14px rgba(168,85,247,0.35);}
    .btn-purple:hover{transform:translateY(-2px);filter:brightness(1.1);}
    .btn-danger{background:transparent;border:2px solid var(--red);color:var(--red);}
    .btn-danger:hover{background:rgba(255,107,107,0.1);}
  </style>
</head>
<body>

<div id="custom-cat-modal" class="modal-overlay hidden">
  <div class="modal-box">
    <h2>âœï¸ Create Custom Category</h2>
    <p>Make your own category for this round! Give it a name and add 5 items to rank.</p>
    <div class="modal-field">
      <label>Category Name</label>
      <input type="text" id="custom-cat-name" placeholder="e.g. Best Family Vacations" maxlength="40">
    </div>
    <div class="modal-field">
      <label>5 Items to Rank</label>
      <div class="item-inputs">
        <div class="item-input-row"><span class="item-num">1</span><input type="text" class="custom-item-input" placeholder="Item 1" maxlength="30"></div>
        <div class="item-input-row"><span class="item-num">2</span><input type="text" class="custom-item-input" placeholder="Item 2" maxlength="30"></div>
        <div class="item-input-row"><span class="item-num">3</span><input type="text" class="custom-item-input" placeholder="Item 3" maxlength="30"></div>
        <div class="item-input-row"><span class="item-num">4</span><input type="text" class="custom-item-input" placeholder="Item 4" maxlength="30"></div>
        <div class="item-input-row"><span class="item-num">5</span><input type="text" class="custom-item-input" placeholder="Item 5" maxlength="30"></div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeCustomModal()">Cancel</button>
      <button class="btn btn-purple" onclick="saveCustomCategory()">âœ“ Add Category</button>
    </div>
  </div>
</div>

<div id="version-banner" onclick="dismissBanner()">
  <div class="vb-dot"></div>
  âœ¨ v4.1 â€” 300+ Categories Â· HP Â· Marvel Â· Disney Â· South Park & More!
  <span class="vb-x">âœ•</span>
</div>

<div id="fb-status"></div>
<div class="toast" id="toast"></div>

<!-- LANDING -->
<div id="landing" class="page">
  <div class="logo">Order Up!</div>
  <div class="logo-sub">Rank it Â· Match it Â· Win it</div>
  <div class="role-cards">
    <div class="role-card" onclick="goHost()"><div class="ico">ğŸ®</div><h2>Host</h2><p>Create a room, pick categories &amp; rank</p></div>
    <div class="role-card" onclick="toggleJoinBox()"><div class="ico">ğŸŒ¸</div><h2>Player</h2><p>Join a room &amp; guess the host's order</p></div>
  </div>
  <div class="join-box hidden" id="join-box">
    <label>Enter Room Code</label>
    <div class="join-row">
      <input type="text" id="join-code" maxlength="6" placeholder="ABC123"
        style="text-transform:uppercase;letter-spacing:4px;font-family:'Playfair Display',serif;font-size:20px;"
        onkeydown="if(event.key==='Enter')joinAndGo()">
      <button class="btn btn-primary" onclick="joinAndGo()">Join â†’</button>
    </div>
  </div>
</div>

<!-- NAME SCREEN -->
<div id="name-screen" class="page hidden">
  <h2>What's Your Name?</h2>
  <p>This shows on the leaderboard ğŸŒ¸</p>
  <div class="name-form">
    <input type="text" id="player-name-input" placeholder="Your nickname" maxlength="20" onkeydown="if(event.key==='Enter')confirmName()">
    <button class="btn btn-primary" onclick="confirmName()">Let's Go â†’</button>
  </div>
</div>

<!-- HOST LOBBY -->
<div id="host-lobby" class="page hidden">
  <div class="top-bar"><div class="badge">HOST</div><div id="pcnt" style="color:var(--muted);font-size:13px;">0 players</div></div>
  <div class="room-code-block">
    <label>Room Code â€” Share This!</label>
    <div class="room-code" id="room-code-display">------</div>
  </div>
  <div class="lobby-grid">
    <div class="panel"><h3>ğŸ“± Scan to Join</h3><div id="qr-wrap"><div id="qr-inner"></div></div><div class="join-url" id="join-url-text"></div></div>
    <div class="panel"><h3>ğŸŒ¸ Players Joined</h3><div class="player-list" id="player-list"><div class="no-players">Waiting for playersâ€¦</div></div></div>
  </div>
  <div style="margin-top:20px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center;">
    <button class="btn btn-primary" onclick="goPickCategory()">Pick Category &amp; Start Round â†’</button>
  </div>
  <div id="rounds-summary" style="margin-top:12px;color:var(--muted);font-size:12px;text-align:center;"></div>
</div>

<!-- HOST CATEGORY PICK -->
<div id="host-pick-screen" class="page hidden">
  <div class="top-bar" style="max-width:920px;">
    <div class="badge">HOST</div>
    <div style="display:flex;gap:10px;align-items:center;">
      <span id="pick-round-label" style="color:var(--muted);font-size:12px;"></span>
      <span id="cat-count-display" class="cat-count-badge"></span>
      <button class="btn btn-ghost" style="padding:7px 13px;font-size:12px;" onclick="showPage('host-lobby')">â† Lobby</button>
    </div>
  </div>
  <div class="game-head" style="margin-bottom:10px;"><h1>Pick a Category</h1><p>Choose what players will rank this round</p></div>
  <div class="type-tabs" id="type-tabs"></div>
  <div class="pick-controls">
    <input type="text" id="cat-search-input" placeholder="ğŸ” Search categoriesâ€¦" oninput="filterCategories()">
    <button class="btn btn-random" id="random-btn" onclick="pickRandomCategory()">
      <span class="dice">ğŸ²</span> Random!
    </button>
    <button class="btn btn-purple" onclick="openCustomModal()">âœï¸ Custom</button>
  </div>
  <div class="cat-grid" id="cat-grid"></div>
  <button class="btn btn-primary" id="start-round-btn" onclick="startRound()" disabled>Start Round â†’</button>
</div>

<!-- HOST GAME -->
<div id="host-game-screen" class="page hidden">
  <div class="game-wrap">
    <div class="top-bar" style="max-width:480px;"><div class="badge">HOST</div><span id="host-round-badge" class="round-badge"></span></div>
    <div class="game-head"><h1>Your Secret Ranking</h1><p>Tap an item, then tap a slot â€” players must guess this!</p></div>
    <div id="host-cat-label" class="cat-label"></div>
    <div class="locked-bar">ğŸ”’ Hidden from players until you reveal</div>
    <div class="rank-labels"><span class="rl top">â­ FAVORITE / BEST (#1)</span><span class="rl bot">LEAST FAVORITE â–¼</span></div>
    <div class="tap-hint" id="host-tap-hint">ğŸ‘† <b>Tap an item</b> on the right â†’ then <b>tap a slot</b> to place it</div>
    <div class="rank-arena">
      <div class="rank-slots" id="host-slots"></div>
      <div class="item-pool" id="host-pool-wrap">
        <div class="pool-label">Tap to pick</div>
        <div id="host-pool"></div>
      </div>
    </div>
    <div style="margin-top:16px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center;">
      <button class="btn btn-ghost" onclick="showPage('host-lobby')">â† Lobby</button>
      <button class="btn btn-primary" id="lock-btn" onclick="lockHostOrder()">ğŸ”’ Lock In My Order</button>
      <button class="btn btn-danger" onclick="skipRound()">â­ Skip Round</button>
    </div>
    <div id="reveal-wrap" class="hidden" style="margin-top:12px;width:100%;max-width:480px;">
      <div id="players-progress-host" style="margin-bottom:12px;"></div>
      <div style="text-align:center;"><button class="btn btn-outline" onclick="revealRound()">ğŸŒ¸ Reveal Round Results!</button></div>
    </div>
    <div id="lock-msg" style="margin-top:9px;color:var(--muted);font-size:12px;text-align:center;"></div>
  </div>
</div>

<!-- WAITING -->
<div id="waiting-screen" class="page hidden">
  <div class="spinner"></div>
  <h2 style="font-family:'Playfair Display',serif;font-size:26px;color:var(--pink-light);margin-bottom:7px;">Waiting for Host</h2>
  <p style="color:var(--muted);margin-bottom:18px;">The host will start the round soonâ€¦</p>
  <div style="background:var(--card);border:1px solid var(--border);border-radius:11px;padding:12px 24px;text-align:center;">
    <div style="color:var(--muted);font-size:10px;letter-spacing:2px;text-transform:uppercase;margin-bottom:5px;">Room</div>
    <div id="wait-code" style="font-family:'Playfair Display',serif;font-size:30px;color:var(--pink);letter-spacing:7px;"></div>
  </div>
  <div id="wait-info" style="margin-top:13px;color:var(--muted);font-size:12px;"></div>
  <div id="wait-pts" class="total-pts" style="margin-top:6px;"></div>
</div>

<!-- PLAYER GAME -->
<div id="player-game-screen" class="page hidden">
  <div class="game-wrap">
    <div class="top-bar" style="max-width:480px;">
      <div class="badge player-badge">PLAYER</div>
      <div style="display:flex;gap:10px;align-items:center;">
        <span id="player-round-badge" class="round-badge"></span>
        <span id="player-pts-badge" class="total-pts"></span>
      </div>
    </div>
    <div class="game-head"><h1>Guess the Host's Order</h1><p>Tap an item, then tap a slot to place it!</p></div>
    <div id="player-cat-label" class="cat-label"></div>
    <div class="rank-labels"><span class="rl top">â­ HOST'S FAVORITE (#1)</span><span class="rl bot">LEAST FAVORITE â–¼</span></div>
    <div class="tap-hint" id="player-tap-hint">ğŸ‘† <b>Tap an item</b> on the right â†’ then <b>tap a slot</b> to place it</div>
    <div class="rank-arena">
      <div class="rank-slots" id="player-slots"></div>
      <div class="item-pool" id="player-pool-wrap">
        <div class="pool-label">Tap to pick</div>
        <div id="player-pool"></div>
      </div>
    </div>
    <button class="btn btn-primary" id="submit-btn" style="margin-top:15px;" onclick="submitOrder()">Submit My Guess âœ“</button>
    <div id="sub-banner" class="hidden"><div class="sub-banner">âœ… Submitted! Waiting for host to revealâ€¦</div></div>
  </div>
</div>

<!-- ROUND RESULTS -->
<div id="round-results-screen" class="page hidden">
  <div class="rr-title" id="rr-title">Round Results</div>
  <p style="color:var(--muted);margin-bottom:4px;" id="rr-cat-label"></p>
  <div id="player-own-results" class="hidden" style="width:100%;max-width:420px;">
    <div class="your-score-box"><div class="score-num" id="rr-your-score">0/5</div><div class="score-label">correct placements this round</div></div>
    <p class="result-section-title">Your Answers vs Host's Order</p>
    <ul class="slist" id="player-result-list"></ul>
  </div>
  <div style="width:100%;max-width:420px;">
    <p class="result-section-title" style="margin-top:14px;">ğŸ† Host's Actual Ranking</p>
    <div class="rank-labels"><span class="rl top">â­ FAVORITE</span><span class="rl bot">LEAST FAVORITE â–¼</span></div>
    <ul class="slist" id="rr-host-list"></ul>
  </div>
  <hr class="divider">
  <div class="lb"><h3>ğŸ“Š Round Leaderboard</h3><div id="rr-lb-list"></div></div>
  <div style="margin-top:20px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center;" id="rr-buttons"></div>
</div>

<!-- FINAL RESULTS -->
<div id="final-results-screen" class="page hidden">
  <div class="confetti-row">ğŸŒ¸âœ¨ğŸ’–âœ¨ğŸŒ¸</div>
  <div class="final-title">Game Over!</div>
  <p style="color:var(--muted);margin-bottom:20px;">Final Scores â€” All Rounds</p>
  <div class="winner-card"><div class="crown">ğŸ‘‘</div><div class="winner-name" id="winner-name">-</div><div class="winner-pts" id="winner-pts">-</div></div>
  <div class="lb" style="max-width:480px;"><h3>ğŸ† Final Leaderboard</h3><div id="final-lb-list"></div></div>
  <div style="margin-top:24px;"><button class="btn btn-primary" onclick="location.reload()">Play Again ğŸŒ¸</button></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
function dismissBanner(){
  var b=document.getElementById('version-banner');
  b.classList.add('gone');
  setTimeout(function(){b.style.display='none';},400);
}
setTimeout(dismissBanner, 7000);

if(typeof firebase === 'undefined'){
  document.getElementById('fb-status').textContent='âš ï¸ Firebase failed to load â€” check your internet connection';
  document.getElementById('fb-status').className='err';
}
firebase.initializeApp({
  apiKey:"AIzaSyCoRWphqnWGI3oO2WkNXL7oSLCe7Py_09w",
  authDomain:"orderup-c928b.firebaseapp.com",
  databaseURL:"https://orderup-c928b-default-rtdb.firebaseio.com",
  projectId:"orderup-c928b",
  storageBucket:"orderup-c928b.firebasestorage.app",
  messagingSenderId:"436213481520",
  appId:"1:436213481520:web:91e6c3e57872f90ff32df5"
});
var db;
try{
  db=firebase.database();
  db.ref('.info/connected').on('value',function(s){
    var b=document.getElementById('fb-status');
    if(s.val()){b.textContent='âœ… Connected!';b.className='ok';setTimeout(function(){b.style.display='none';},2200);}
    else{b.textContent='âš ï¸ Not connected â€” fix Firebase rules at console.firebase.google.com';b.className='err';}
  });
}catch(e){
  document.getElementById('fb-status').textContent='âš ï¸ Firebase error: '+e.message;
  document.getElementById('fb-status').className='err';
}

// â”€â”€ CATEGORIES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var CATEGORIES=[

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // HARRY POTTER (Movies)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Harry Potter',name:'HP Films Ranked',items:["Sorcerer's Stone","Chamber of Secrets","Prisoner of Azkaban","Goblet of Fire","Order of the Phoenix"]},
  {type:'Harry Potter',name:'HP Films Part 2',items:["Half-Blood Prince","Deathly Hallows Part 1","Deathly Hallows Part 2","Fantastic Beasts 1","Fantastic Beasts 2"]},
  {type:'Harry Potter',name:'Hogwarts Houses',items:['Gryffindor','Slytherin','Ravenclaw','Hufflepuff','Beauxbatons']},
  {type:'Harry Potter',name:'HP Main Characters',items:['Harry Potter','Hermione Granger','Ron Weasley','Draco Malfoy','Luna Lovegood']},
  {type:'Harry Potter',name:'HP Professors',items:['Dumbledore','Snape','McGonagall','Lupin','Umbridge']},
  {type:'Harry Potter',name:'HP Villains & Antagonists',items:['Voldemort','Dolores Umbridge','Bellatrix Lestrange','Draco Malfoy','Peter Pettigrew']},
  {type:'Harry Potter',name:'HP Magical Creatures',items:['Hippogriff','Basilisk','Thestral','Hungarian Horntail','Dobby the House Elf']},
  {type:'Harry Potter',name:'HP Spells',items:['Expecto Patronum','Avada Kedavra','Expelliarmus','Lumos','Wingardium Leviosa']},
  {type:'Harry Potter',name:'HP Weasley Family Members',items:['Fred Weasley','George Weasley','Ginny Weasley','Percy Weasley','Molly Weasley']},
  {type:'Harry Potter',name:'HP Iconic Movie Moments',items:['Diagon Alley reveal','The Sorting Hat','The Triwizard Tournament','The Battle of Hogwarts','Snape\'s memories in the Pensieve']},
  {type:'Harry Potter',name:'HP Quidditch Positions',items:['Seeker','Keeper','Beater','Chaser','Team Captain']},
  {type:'Harry Potter',name:'Marauders',items:['Sirius Black','Remus Lupin','James Potter','Peter Pettigrew','Lily Evans']},
  {type:'Harry Potter',name:'HP Magical Objects',items:['The Invisibility Cloak','The Elder Wand','The Marauder\'s Map','The Sorting Hat','The Horcrux Locket']},
  {type:'Harry Potter',name:'Fantastic Beasts Characters',items:['Newt Scamander','Tina Goldstein','Jacob Kowalski','Queenie Goldstein','Gellert Grindelwald']},
  {type:'Harry Potter',name:'HP Death Eaters',items:['Bellatrix Lestrange','Lucius Malfoy','Peter Pettigrew','Fenrir Greyback','Dolores Umbridge']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SHERLOCK (BBC)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Sherlock',name:'Sherlock Episodes Ranked',items:['A Study in Pink','The Great Game','A Scandal in Belgravia','The Hounds of Baskerville','The Reichenbach Fall']},
  {type:'Sherlock',name:'Sherlock Series Ranked',items:['Series 1','Series 2','Series 3','Series 4','The Abominable Bride Special']},
  {type:'Sherlock',name:'Sherlock Characters',items:['Sherlock Holmes','John Watson','Irene Adler','Jim Moriarty','Mycroft Holmes']},
  {type:'Sherlock',name:'Sherlock Supporting Cast',items:['Mrs. Hudson','Greg Lestrade','Molly Hooper','Mary Morstan','Anderson']},
  {type:'Sherlock',name:'Sherlock Iconic Moments',items:['I am Sherlock Holmes','The Fall from St. Bart\'s','The Empty Hearse reveal','Irene Adler\'s entrance','Moriarty on the roof']},
  {type:'Sherlock',name:'Sherlock Holmes Traits',items:['Deductive reasoning','Violin playing','Drug use history','Sociopathy claim','Memory palace']},
  {type:'Sherlock',name:'Sherlock Villains',items:['Jim Moriarty','Irene Adler (sort of)','Charles Magnussen','Eurus Holmes','Mary Morstan (season 3)']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // HANNIBAL (TV Show)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Hannibal',name:'Hannibal Seasons',items:['Season 1 (ApÃ©ritif)','Season 2 (Kaiseki)','Season 3 Part 1 (Italy)','Season 3 Part 2 (Red Dragon)','Silence of the Lambs film']},
  {type:'Hannibal',name:'Hannibal Characters',items:['Hannibal Lecter','Will Graham','Alana Bloom','Jack Crawford','Frederick Chilton']},
  {type:'Hannibal',name:'Hannibal Supporting Characters',items:['Abigail Hobbs','Beverly Katz','Bedelia du Maurier','Mason Verger','Francis Dolarhyde']},
  {type:'Hannibal',name:'Hannibal Iconic Episodes',items:['ApÃ©ritif (S1E1)','Mizumono (S2 finale)','Digestivo (S3)','The Wrath of the Lamb (finale)','RelevÃ©s (S1)']},
  {type:'Hannibal',name:'Hannibal Dinner Party Dishes (In-Show)',items:['Lung prosciutto','Human ear amuse-bouche','Ortolan','Braised pork cheeks','Lung and truffles']},
  {type:'Hannibal',name:'Hannibal Killers / Antagonists',items:['Hannibal Lecter','Garret Jacob Hobbs','Francis Dolarhyde','Mason Verger','Randall Tier']},
  {type:'Hannibal',name:'Hannibal Relationship Dynamics',items:['Hannibal & Will (Hannigram)','Will & Alana','Hannibal & Bedelia','Alana & Margot','Jack & Bella']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // GOOD OMENS (TV Show)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Good Omens',name:'Good Omens Characters',items:['Aziraphale','Crowley','Adam Young','Anathema Device','Newton Pulsifer']},
  {type:'Good Omens',name:'Good Omens Season 1 Episodes',items:['In the Beginning','The Book','Hard Times','Saturday Morning Funtime','The Doomsday Option']},
  {type:'Good Omens',name:'Good Omens Celestial Beings',items:['Aziraphale','Gabriel','Michael','Sandalphon','Beelzebub']},
  {type:'Good Omens',name:'Good Omens Iconic Moments',items:['Arrangement under the apple tree','Bentley & Queen on the motorway','The Ritz lunch','Crowley threatens heaven','Book shop destruction']},
  {type:'Good Omens',name:'Good Omens Season 2 Storylines',items:['Job minisode','Edinburgh minisode','Gabriel\'s amnesia','Maggie & Nina romance','Final bookshop scene']},
  {type:'Good Omens',name:'Crowley\'s Best Lines',items:['"I\'m an Angel!"','The plants speech','The Job argument','The Arrangement proposal','The Metatron confrontation']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUPERNATURAL (TV Show)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Supernatural',name:'Supernatural Seasons',items:['Season 1','Season 2','Season 4','Season 5','Season 8']},
  {type:'Supernatural',name:'Supernatural Characters',items:['Dean Winchester','Sam Winchester','Castiel','Bobby Singer','Crowley']},
  {type:'Supernatural',name:'Supernatural Supporting Cast',items:['Ellen Harvelle','Jo Harvelle','Charlie Bradbury','Benny Lafitte','Kevin Tran']},
  {type:'Supernatural',name:'Supernatural Angels',items:['Castiel','Gabriel','Balthazar','Metatron','Lucifer']},
  {type:'Supernatural',name:'Supernatural Villains',items:['Yellow Eyes (Azazel)','Lilith','Lucifer','Dick Roman','The Darkness (Amara)']},
  {type:'Supernatural',name:'Supernatural Monsters of the Week',items:['Wendigo','Shapeshifter','Djinn','Rugaru','Leviathan']},
  {type:'Supernatural',name:'Supernatural Iconic Episodes',items:['Pilot','In My Time of Dying','Mystery Spot','The French Mistake','Swan Song']},
  {type:'Supernatural',name:'Supernatural Road Trip Essentials',items:['Baby (the Impala)','Classic rock cassettes','Pie','Dean\'s leather jacket','The Colt']},
  {type:'Supernatural',name:'Best Dean Winchester Moments',items:['Baby driving scenes','Pie eating','"Carry On Wayward Son"','Purgatory scenes','The final episode speech']},
  {type:'Supernatural',name:'Supernatural Crossroads Deals',items:['Dean sells soul for Sam','Bobby\'s deal','Crowley\'s wheeling and dealing','The deal in Season 10','Sam\'s many near-death deals']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // DISNEY (Movies & TV)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Disney',name:'Disney Renaissance Films',items:['The Little Mermaid','Beauty and the Beast','Aladdin','The Lion King','Mulan']},
  {type:'Disney',name:'Disney Revival Films',items:['Tangled','Brave','Frozen','Moana','Encanto']},
  {type:'Disney',name:'Disney Animated Films (2000s)',items:['Lilo & Stitch','Treasure Planet','Brother Bear','Home on the Range','Chicken Little']},
  {type:'Disney',name:'Disney Sidekicks',items:['Timon & Pumbaa','Genie','Mushu','Pascal & Maximus','Olaf']},
  {type:'Disney',name:'Disney Princess Romances',items:['Ariel & Eric','Belle & Beast','Jasmine & Aladdin','Cinderella & Prince Charming','Rapunzel & Flynn']},
  {type:'Disney',name:'Disney Villains Ranked',items:['Ursula','Maleficent','Hades','Gaston','The Evil Queen']},
  {type:'Disney',name:'Disney Songs (Classic)',items:['Part of Your World','Be Our Guest','A Whole New World','Hakuna Matata','Under the Sea']},
  {type:'Disney',name:'Disney Songs (Modern)',items:['Let It Go','How Far I\'ll Go','Into the Unknown','What Was I Missing','Surface Pressure']},
  {type:'Disney',name:'Disney Channel Original Movies',items:['High School Musical','Zenon: Girl of the 21st Century','Hocus Pocus','Twitches','Cheetah Girls']},
  {type:'Disney',name:'Disney Channel Shows (2000s)',items:['Lizzie McGuire','Even Stevens','That\'s So Raven','Kim Possible','Pepper Ann']},
  {type:'Disney',name:'Disney Channel Shows (2010s)',items:['Good Luck Charlie','Shake It Up','ANT Farm','Jessie','Girl Meets World']},
  {type:'Disney',name:'Disney Parks Rides',items:['Haunted Mansion','Space Mountain','Pirates of the Caribbean','Splash Mountain','It\'s a Small World']},
  {type:'Disney',name:'Disney Pixar Originals',items:['Toy Story','Finding Nemo','The Incredibles','WALL-E','Up']},
  {type:'Disney',name:'Disney Franchise Characters',items:['Mickey Mouse','Minnie Mouse','Donald Duck','Goofy','Pluto']},
  {type:'Disney',name:'Disney Live Action Remakes',items:['The Lion King (2019)','Beauty and the Beast (2017)','Cinderella (2015)','Aladdin (2019)','The Little Mermaid (2023)']},
  {type:'Disney',name:'Disney Princesses (All Time)',items:['Cinderella','Ariel','Belle','Jasmine','Moana']},
  {type:'Disney',name:'Disney Animals',items:['Simba','Bambi','Dumbo','Lady (Lady & the Tramp)','Copper (Fox & the Hound)']},
  {type:'Disney',name:'Disney Underrated Films',items:['Treasure Planet','Atlantis','The Emperor\'s New Groove','Hunchback of Notre Dame','Tarzan']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // MARVEL (Movies Only)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Marvel',name:'Avengers Films',items:['The Avengers','Age of Ultron','Infinity War','Endgame','Civil War']},
  {type:'Marvel',name:'MCU Phase 1',items:['Iron Man','The Incredible Hulk','Iron Man 2','Thor','Captain America: The First Avenger']},
  {type:'Marvel',name:'MCU Phase 2',items:['Iron Man 3','Thor: The Dark World','Captain America: The Winter Soldier','Guardians of the Galaxy','Avengers: Age of Ultron']},
  {type:'Marvel',name:'MCU Phase 3',items:['Captain America: Civil War','Doctor Strange','Spider-Man: Homecoming','Thor: Ragnarok','Black Panther']},
  {type:'Marvel',name:'MCU Phase 4 Films',items:['Black Widow','Shang-Chi','Eternals','Spider-Man: No Way Home','Doctor Strange in the Multiverse of Madness']},
  {type:'Marvel',name:'MCU Phase 5 Films',items:['Ant-Man and the Wasp: Quantumania','Guardians Vol. 3','The Marvels','Deadpool & Wolverine','Captain America: Brave New World']},
  {type:'Marvel',name:'Marvel Heroes',items:['Iron Man','Captain America','Thor','Black Widow','Hulk']},
  {type:'Marvel',name:'Marvel Villains',items:['Thanos','Loki','Ultron','Killmonger','Hela']},
  {type:'Marvel',name:'Spider-Man Films',items:['Spider-Man (2002)','Spider-Man 2','The Amazing Spider-Man','Homecoming','No Way Home']},
  {type:'Marvel',name:'Iron Man Films',items:['Iron Man','Iron Man 2','Iron Man 3','Civil War (Tony\'s arc)','Endgame (Tony\'s arc)']},
  {type:'Marvel',name:'Thor Films',items:['Thor','The Dark World','Ragnarok','Infinity War (Thor)','Love and Thunder']},
  {type:'Marvel',name:'Marvel Female Heroes',items:['Black Widow','Scarlet Witch','Gamora','Valkyrie','Captain Marvel']},
  {type:'Marvel',name:'Guardians of the Galaxy Characters',items:['Star-Lord','Gamora','Drax','Rocket','Groot']},
  {type:'Marvel',name:'Marvel Post-Credit Scenes',items:['Nick Fury after Iron Man','Thanos gloving after Avengers','Spider-Man after Homecoming','Ant-Man after Winter Soldier','Doctor Strange after Thor 2']},
  {type:'Marvel',name:'MCU Emotional Moments',items:['Tony\'s snap','Steve\'s goodbye to Peggy','Yondu\'s death','Vision\'s creation','Gamora\'s death in Infinity War']},
  {type:'Marvel',name:'Marvel Bromances',items:['Tony & Steve','Thor & Loki','Peter & Tony','Bucky & Steve','Rocket & Groot']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SOUTH PARK
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'South Park',name:'South Park Main Boys',items:['Eric Cartman','Stan Marsh','Kyle Broflovski','Kenny McCormick','Butters Stotch']},
  {type:'South Park',name:'South Park Side Characters',items:['Randy Marsh','Mr. Garrison','Chef','PC Principal','Tweek & Craig']},
  {type:'South Park',name:'Best South Park Seasons',items:['Season 5','Season 8','Season 12','Season 19','Season 23']},
  {type:'South Park',name:'Iconic South Park Episodes',items:['Scott Tenorman Must Die','Make Love Not Warcraft','Imaginationland','Trapped in the Closet','The Return of Chef']},
  {type:'South Park',name:'South Park Specials & Movies',items:['Bigger Longer & Uncut','Post COVID','The Streaming Wars','Joining the Panderverse','Back to the Future']},
  {type:'South Park',name:'Cartman\'s Best Schemes',items:['Faking Tourette\'s','The Scott Tenorman revenge','T.M.I. episode','Saving Shaun of the Dead','Human Centipede parody']},
  {type:'South Park',name:'South Park Recurring Jokes',items:['Kenny dying','Oh my God they killed Kenny!','Cartman saying "Screw you guys"','Stan\'s relationship with Wendy','Randy being ridiculous']},
  {type:'South Park',name:'South Park Parody Targets',items:['Scientology','Walmart','Black Friday','COVID','The Streaming Wars']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // EMO MUSIC
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Emo Music',name:'Emo Bands Ranked',items:['My Chemical Romance','Fall Out Boy','Panic! at the Disco','Paramore','Hawthorne Heights']},
  {type:'Emo Music',name:'More Emo Bands',items:['Taking Back Sunday','Dashboard Confessional','Brand New','The Used','Thursday']},
  {type:'Emo Music',name:'MCR Albums',items:['I Brought You My Bullets','Three Cheers for Sweet Revenge','The Black Parade','Danger Days','The Black Parade (reissue)']},
  {type:'Emo Music',name:'Fall Out Boy Albums',items:['From Under the Cork Tree','Infinity on High','Folie Ã  Deux','Save Rock and Roll','American Beauty/American Psycho']},
  {type:'Emo Music',name:'Panic! at the Disco Albums',items:['A Fever You Can\'t Sweat Out','Pretty. Odd.','Vices & Virtues','Too Weird to Live','Death of a Bachelor']},
  {type:'Emo Music',name:'Paramore Albums',items:['All We Know Is Falling','Riot!','Brand New Eyes','Paramore (self-titled)','After Laughter']},
  {type:'Emo Music',name:'Iconic Emo Songs',items:['"Welcome to the Black Parade"','"Sugar We\'re Goin Down"','"I Write Sins Not Tragedies"','"Misery Business"','"Ohio is for Lovers"']},
  {type:'Emo Music',name:'Emo Adjacent Bands',items:['Linkin Park','Evanescence','Simple Plan','Good Charlotte','Sum 41']},
  {type:'Emo Music',name:'Emo Era Aesthetic Elements',items:['Side-swept bangs','Studded belts','Black skinny jeans','Band tees','Heavy eyeliner']},
  {type:'Emo Music',name:'Emo Subgenres',items:['Screamo','Post-hardcore','Pop punk','Midwest emo','Skramz']},
  {type:'Emo Music',name:'Iconic Emo Music Videos',items:['Welcome to the Black Parade','Sugar We\'re Goin Down','I Write Sins Not Tragedies','Misery Business','Check Yes Juliet']},
  {type:'Emo Music',name:'Emo Era Hot Boys',items:['Gerard Way','Pete Wentz','Brendon Urie','Hayley Williams (honorary)','Bert McCracken']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // POP MUSIC
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Pop Music',name:'Pop Divas All Time',items:['BeyoncÃ©','Mariah Carey','Whitney Houston','Madonna','Celine Dion']},
  {type:'Pop Music',name:'2000s Pop Queens',items:['Britney Spears','Christina Aguilera','Shakira','Avril Lavigne','Nelly Furtado']},
  {type:'Pop Music',name:'2010s Pop Queens',items:['Taylor Swift','Katy Perry','Lady Gaga','Rihanna','Ariana Grande']},
  {type:'Pop Music',name:'2020s Pop Girls',items:['Olivia Rodrigo','Dua Lipa','Sabrina Carpenter','Chappell Roan','Billie Eilish']},
  {type:'Pop Music',name:'Pop Boy Bands',items:['Backstreet Boys','NSYNC','One Direction','Jonas Brothers','New Kids on the Block']},
  {type:'Pop Music',name:'Pop Collab Songs',items:['Telephone (Gaga & BeyoncÃ©)','Side to Side (Ariana & Nicki)','Work It Out (JT & Jay-Z)','Fancy (Iggy & Charli)','No Tears Left to Cry remix']},
  {type:'Pop Music',name:'Bops That Defined Summers',items:['Call Me Maybe','Blurred Lines','Happy','Uptown Funk','Old Town Road']},
  {type:'Pop Music',name:'Pop Albums of the Decade (2010s)',items:['1989 - Taylor Swift','Lemonade - BeyoncÃ©','Anti - Rihanna','Thank U Next - Ariana','Ã· Divide - Ed Sheeran']},
  {type:'Pop Music',name:'Pop Music Award Shows',items:['MTV VMAs','Grammy Awards','Billboard Music Awards','American Music Awards','People\'s Choice Awards']},
  {type:'Pop Music',name:'Most Iconic Pop Music Moments',items:['Britney shaves head','Lady Gaga\'s meat dress','BeyoncÃ© Coachella','Taylor\'s Re-Recordings','Kanye interrupts Taylor']},
  {type:'Pop Music',name:'Pop Feuds',items:['Taylor vs Katy','Nicki vs Cardi','Mariah vs Jennifer','Britney vs Christina','BeyoncÃ© vs everyone (she wins)']},
  {type:'Pop Music',name:'Pop Music Dance Moves',items:['Single Ladies choreo','YMCA','The Macarena','Gangnam Style horse dance','Soulja Boy crank dat']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 80s MOVIES
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'80s Movies',name:'80s Teen Comedies',items:['Ferris Bueller\'s Day Off','The Breakfast Club','Sixteen Candles','Pretty in Pink','Fast Times at Ridgemont High']},
  {type:'80s Movies',name:'80s Action Films',items:['Die Hard','The Terminator','RoboCop','Lethal Weapon','Predator']},
  {type:'80s Movies',name:'80s Sci-Fi Films',items:['E.T.','Back to the Future','Blade Runner','The Thing','Aliens']},
  {type:'80s Movies',name:'80s Horror Films',items:['A Nightmare on Elm Street','Friday the 13th','The Shining','Poltergeist','Hellraiser']},
  {type:'80s Movies',name:'80s Fantasy & Adventure',items:['The NeverEnding Story','Labyrinth','The Princess Bride','Willow','The Dark Crystal']},
  {type:'80s Movies',name:'80s Comedies',items:['Ghostbusters','Beetlejuice','Trading Places','Beverly Hills Cop','Planes Trains and Automobiles']},
  {type:'80s Movies',name:'John Hughes Films',items:['The Breakfast Club','Ferris Bueller\'s Day Off','Sixteen Candles','Pretty in Pink','Home Alone']},
  {type:'80s Movies',name:'80s Blockbusters',items:['Raiders of the Lost Ark','Return of the Jedi','E.T.','Beverly Hills Cop','Top Gun']},
  {type:'80s Movies',name:'80s Coming-of-Age Films',items:['Stand by Me','The Outsiders','Say Anything','Some Kind of Wonderful','The Karate Kid']},
  {type:'80s Movies',name:'80s Romance Films',items:['Dirty Dancing','Footloose','An Officer and a Gentleman','When Harry Met Sally','St. Elmo\'s Fire']},
  {type:'80s Movies',name:'80s Movie Soundtracks',items:['Dirty Dancing','Footloose','The Breakfast Club','Top Gun','Beverly Hills Cop']},
  {type:'80s Movies',name:'Brat Pack Films',items:['The Breakfast Club','St. Elmo\'s Fire','Pretty in Pink','Sixteen Candles','About Last Night']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 2000s MOVIES
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'2000s Movies',name:'2000s Teen Films',items:['Mean Girls','Bring It On','13 Going on 30','A Cinderella Story','The Princess Diaries']},
  {type:'2000s Movies',name:'2000s Blockbusters',items:['Spider-Man','Pirates of the Caribbean','Shrek','Lord of the Rings: Fellowship','Harry Potter 1']},
  {type:'2000s Movies',name:'2000s Horror Films',items:['The Ring','Saw','The Grudge','Final Destination','Insidious']},
  {type:'2000s Movies',name:'2000s Animated Films',items:['Shrek','Finding Nemo','The Incredibles','Ice Age','Kung Fu Panda']},
  {type:'2000s Movies',name:'2000s Rom-Coms',items:['How to Lose a Guy in 10 Days','Hitch','50 First Dates','The Wedding Planner','Legally Blonde 2']},
  {type:'2000s Movies',name:'2000s Oscar Films',items:['Gladiator','A Beautiful Mind','Chicago','Return of the King','Crash']},
  {type:'2000s Movies',name:'2000s Guilty Pleasure Films',items:['The Hot Chick','White Chicks','Deuce Bigalow','Joe Dirt','Crossroads']},
  {type:'2000s Movies',name:'2000s Action Films',items:['The Bourne Identity','Mission Impossible 2','Kill Bill','The Dark Knight','Batman Begins']},
  {type:'2000s Movies',name:'2000s Chick Flicks',items:['Legally Blonde','Mamma Mia','The Devil Wears Prada','27 Dresses','Bride Wars']},
  {type:'2000s Movies',name:'2000s Comedy Films',items:['Superbad','Knocked Up','Blades of Glory','Wedding Crashers','Step Brothers']},
  {type:'2000s Movies',name:'2000s Sequels',items:['Shrek 2','Pirates 2','Spider-Man 2','X2: X-Men United','Harry Potter 2']},
  {type:'2000s Movies',name:'2000s Fantasy Films',items:['Harry Potter','Lord of the Rings','Narnia','Eragon','Stardust']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // KIDS SHOWS 2000-2010s
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'Kids Shows',name:'Nickelodeon 2000s',items:['SpongeBob SquarePants','Fairly OddParents','Danny Phantom','Avatar: The Last Airbender','Invader Zim']},
  {type:'Kids Shows',name:'Nickelodeon 2010s',items:['iCarly','Victorious','Big Time Rush','Bucket & Skinner','The Thundermans']},
  {type:'Kids Shows',name:'Cartoon Network 2000s',items:['Dexter\'s Lab','The Powerpuff Girls','Ed Edd n Eddy','Courage the Cowardly Dog','Kids Next Door']},
  {type:'Kids Shows',name:'Cartoon Network 2010s',items:['Adventure Time','Regular Show','The Amazing World of Gumball','Steven Universe','Gravity Falls']},
  {type:'Kids Shows',name:'Disney Channel 2000s',items:['Lizzie McGuire','Even Stevens','That\'s So Raven','Kim Possible','Proud Family']},
  {type:'Kids Shows',name:'Disney Channel 2010s',items:['Good Luck Charlie','Shake It Up','ANT Farm','Austin & Ally','Girl Meets World']},
  {type:'Kids Shows',name:'Classic PBS Kids Shows',items:['Arthur','Clifford the Big Red Dog','Cyberchase','Between the Lions','Zoom']},
  {type:'Kids Shows',name:'Preschool Shows (2000s)',items:['Dora the Explorer','Blue\'s Clues','Go Diego Go!','Wow Wow Wubbzy','The Backyardigans']},
  {type:'Kids Shows',name:'Live Action Kids Shows',items:['iCarly','Drake & Josh','Zoey 101','Lizzie McGuire','Phil of the Future']},
  {type:'Kids Shows',name:'Best Cartoon Network Characters',items:['Finn (Adventure Time)','Mordecai & Rigby','Dexter','The Powerpuff Girls','Mac & Bloo (Foster\'s)']},
  {type:'Kids Shows',name:'Iconic Kids Show Theme Songs',items:['SpongeBob theme','Kim Possible theme','iCarly theme','Victorious theme','That\'s So Raven theme']},
  {type:'Kids Shows',name:'Kids Show Villains',items:['Crocker (Fairly OddParents)','Vlad Masters (Danny Phantom)','Aku (Samurai Jack)','Mojo Jojo (Powerpuff Girls)','Zim (Invader Zim)']},
  {type:'Kids Shows',name:'Best Kids Show Episodes',items:['Band Geeks (SpongeBob)','The Ember Island Players (ATLA)','Mystery Dungeoneer (KND)','Quack Pack (Ducktales)','Memory (Adventure Time)']},
  {type:'Kids Shows',name:'2000s Cartoon Duos',items:['Ed & Eddy','Phineas & Ferb','Timmy & Cosmo','Danny & Tucker','Dexter & Dee Dee']},

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 2000s-2010s NOSTALGIA (General)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {type:'2000s Nostalgia',name:'2000s Tech We Loved',items:['iPod','Motorola RAZR','Flip phones','MySpace','AIM Instant Messenger']},
  {type:'2000s Nostalgia',name:'2000s Fashion Trends',items:['Von Dutch hats','Juicy Couture tracksuits','Low-rise jeans','Frosted tips','Platform flip flops']},
  {type:'2000s Nostalgia',name:'2000s Toys & Games',items:['Tamagotchi','Beyblades','Bratz Dolls','Yu-Gi-Oh cards','GameBoy Advance']},
  {type:'2000s Nostalgia',name:'2000s Reality TV',items:['American Idol','The Simple Life','Newlyweds: Nick & Jessica','The Osbournes','America\'s Next Top Model']},
  {type:'2000s Nostalgia',name:'2010s Tech We Loved',items:['iPhone 4','Instagram (original)','Vine','Tumblr','Snapchat']},
  {type:'2000s Nostalgia',name:'2010s Trends',items:['YOLO','Hipster aesthetic','Mason jar everything','Chevron print','Keep Calm posters']},
  {type:'2000s Nostalgia',name:'Things From 2000-2010 We Miss',items:['Blockbuster Video','Saturday morning cartoons','AOL Instant Messenger','Going to the mall','Buying ringtones']},
  {type:'2000s Nostalgia',name:'Things From 2010-2020 We Miss',items:['Vine','Old Tumblr','OG Instagram filters','One Direction','Teen Wolf Tumblr era']},
  {type:'2000s Nostalgia',name:'2000s Celebrity Culture',items:['Paris Hilton era','Lindsay Lohan tabloids','Britney\'s breakdown','The Simple Life','Nicole Richie diet drama']},
  {type:'2000s Nostalgia',name:'2000s Party Hits',items:['In Da Club','Yeah! by Usher','Crazy in Love','Low by Flo Rida','Stronger by Kanye']},
  {type:'2000s Nostalgia',name:'2010s Party Hits',items:['Blurred Lines','Thrift Shop','Call Me Maybe','Uptown Funk','Happy by Pharrell']},
  {type:'2000s Nostalgia',name:'Iconic 2000s Phrases',items:['"That\'s hot" (Paris Hilton)','YOLO','OMG/LOL in real life','"I\'m not here to make friends"','"Voted off the island"']},
  {type:'2000s Nostalgia',name:'2000s School Lunchbox Staples',items:['Lunchables','Capri Sun','Gushers','Dunkaroos','Fruit Roll-Ups']},
  {type:'2000s Nostalgia',name:'2000s After-School Snacks',items:['3D Doritos','Pizza Rolls','Easy Mac','Dunkaroos','Fruit by the Foot']},
  {type:'2000s Nostalgia',name:'2000s Video Games',items:['Guitar Hero','Halo 2','The Sims 2','Kingdom Hearts','Grand Theft Auto: San Andreas']},
  {type:'2000s Nostalgia',name:'2010s Social Media Moments',items:['Gangnam Style going viral','Ice Bucket Challenge','Grumpy Cat memes','Harlem Shake','The Dress (white & gold vs blue & black)']},
  {type:'2000s Nostalgia',name:'Y2K Panic vs Reality',items:['Banks collapsing (didn\'t happen)','Planes falling (didn\'t happen)','Nukes launching (didn\'t happen)','Computers crashing (kinda)','People stockpiling (absolutely happened)']},

  // â”€â”€ ORIGINAL CATEGORIES (kept from original) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {type:'Movies',name:'Hunger Games Films',items:['The Hunger Games','Catching Fire','Mockingjay Part 1','Mockingjay Part 2','Ballad of Songbirds & Snakes']},
  {type:'Movies',name:'Harry Potter Films',items:["Sorcerer's Stone","Chamber of Secrets","Prisoner of Azkaban","Goblet of Fire","Order of the Phoenix"]},
  {type:'Movies',name:'Scream Films',items:['Scream','Scream 2','Scream 3','Scream 4','Scream 5']},
  {type:'Movies',name:'Halloween Films',items:['Halloween (1978)','Halloween II','Halloween H20','Halloween (2018)','Halloween Ends']},
  {type:'Movies',name:'Friday the 13th Films',items:['Friday the 13th','Part 2','Part 3','The Final Chapter','Jason Lives']},
  {type:'Movies',name:'Girl Movies',items:['Mean Girls','Clueless','Heathers','Easy A','Legally Blonde']},
  {type:'Movies',name:'Twilight Films',items:['Twilight','New Moon','Eclipse','Breaking Dawn Part 1','Breaking Dawn Part 2']},
  {type:'Movies',name:'YA Dystopia Films',items:['The Maze Runner','The Scorch Trials','The Death Cure','Divergent','Insurgent']},
  {type:'Movies',name:'Disney Animated (Modern)',items:['Frozen','Frozen II','Tangled','Moana','Raya and the Last Dragon']},
  {type:'Movies',name:'Disney Animated (Classic)',items:['The Little Mermaid','Beauty and the Beast','Aladdin','Cinderella','Snow White']},
  {type:'Movies',name:'Pixar Films',items:['The Incredibles','Up','Inside Out','Coco','Soul']},
  {type:'Movies',name:'Pixar Sequels',items:['Toy Story 2','Toy Story 3','Finding Dory','Incredibles 2','Inside Out 2']},
  {type:'Movies',name:'Marvel Avengers Films',items:['The Avengers','Age of Ultron','Infinity War','Endgame','Civil War']},
  {type:'Movies',name:'Marvel Phase 1 Films',items:['Iron Man','The Incredible Hulk','Iron Man 2','Thor','Captain America: The First Avenger']},
  {type:'Movies',name:'Spider-Man Films',items:['Spider-Man (2002)','Into the Spider-Verse','Homecoming','No Way Home','Across the Spider-Verse']},
  {type:'Movies',name:'DC Films',items:['The Dark Knight','Wonder Woman','Aquaman','Shazam!','The Suicide Squad']},
  {type:'Movies',name:'Batman Films',items:['Batman (1989)','Batman Returns','The Dark Knight','Batman v Superman','The Batman (2022)']},
  {type:'Movies',name:'Rom-Coms',items:['10 Things I Hate About You','Bridget Jones Diary','How to Lose a Guy in 10 Days','Crazy Rich Asians',"To All the Boys I've Loved Before"]},
  {type:'Movies',name:'90s Animated Films',items:['The Lion King','Mulan','Hercules','Tarzan','The Hunchback of Notre Dame']},
  {type:'Movies',name:'2000s Teen Movies',items:['Bring It On','13 Going on 30','A Cinderella Story','Freaky Friday','The Princess Diaries']},
  {type:'Movies',name:'Horror Franchises',items:['A Nightmare on Elm Street','Halloween','Friday the 13th','Scream','The Texas Chain Saw Massacre']},
  {type:'Movies',name:'Psychological Thrillers',items:['Get Out','Hereditary','Midsommar','The Witch','Us']},
  {type:'Movies',name:'Fantasy Adventure Films',items:['The Princess Bride','Labyrinth','The NeverEnding Story','Willow','Stardust']},
  {type:'Movies',name:'Romantic Movies (2000s)',items:['The Notebook','A Walk to Remember','P.S. I Love You','Dear John','The Vow']},
  {type:'Movies',name:'Chick Flicks (2000s)',items:['Mamma Mia','27 Dresses','The Devil Wears Prada','Bride Wars','Sex and the City: The Movie']},
  {type:'Movies',name:'Action Blockbusters',items:['Gladiator','The Dark Knight','Inception','Mad Max: Fury Road','Top Gun: Maverick']},
  {type:'Movies',name:'Animated Dreamworks Films',items:['Shrek','Kung Fu Panda','Madagascar','How to Train Your Dragon','The Prince of Egypt']},
  {type:'Movies',name:'Epic Fantasy',items:['Lord of the Rings: Fellowship','Lord of the Rings: Two Towers','Lord of the Rings: Return of the King','Narnia','Eragon']},
  {type:'Movies',name:'True Story Films',items:['Hidden Figures','Bohemian Rhapsody','The Social Network','Catch Me If You Can','Erin Brockovich']},
  {type:'Movies',name:'Holiday Rom-Coms',items:['Love Actually','The Holiday','Elf','Four Christmases','Last Christmas']},
  {type:'TV',name:'Crime Procedurals',items:['Criminal Minds','Bones','NCIS','Law & Order SVU','Mindhunter']},
  {type:'TV',name:'Supernatural Teen Dramas',items:['Supernatural','The Vampire Diaries','Teen Wolf','The Originals','Buffy the Vampire Slayer']},
  {type:'TV',name:'British Dramas',items:['Sherlock','Doctor Who','Black Mirror','Broadchurch','Luther']},
  {type:'TV',name:'Cult Sci-Fi & Mystery',items:['Stranger Things','The Umbrella Academy','Dark','Yellowjackets','Lost']},
  {type:'TV',name:'Teen Dramas',items:['Glee','Riverdale','Pretty Little Liars','Gossip Girl','The OC']},
  {type:'TV',name:'Reality Competition Shows',items:["RuPaul's Drag Race",'Survivor','The Amazing Race','Big Brother','The Voice']},
  {type:'TV',name:'Animated Adult Shows',items:["Bob's Burgers",'Archer','BoJack Horseman','Futurama','Rick and Morty']},
  {type:'TV',name:'Sitcoms',items:['The Office','Parks and Recreation','Brooklyn Nine-Nine','New Girl',"Schitt's Creek"]},
  {type:'TV',name:'Fantasy & Sci-Fi Dramas',items:['Game of Thrones','The Witcher','Wheel of Time','Shadow and Bone','House of the Dragon']},
  {type:'TV',name:'Netflix Originals',items:['Squid Game','Bridgerton','Outer Banks','Emily in Paris','Wednesday']},
  {type:'TV',name:'Cartoon Network Classics',items:['The Powerpuff Girls',"Dexter's Laboratory",'Ed Edd n Eddy','Courage the Cowardly Dog','Johnny Bravo']},
  {type:'TV',name:'Nickelodeon Classics',items:['SpongeBob SquarePants','Rugrats','Hey Arnold!','Invader Zim','The Fairly OddParents']},
  {type:'TV',name:'Anime Series',items:['Attack on Titan','Demon Slayer','Fullmetal Alchemist: Brotherhood','My Hero Academia','Death Note']},
  {type:'TV',name:'Shojo Anime',items:['Sailor Moon','Fruits Basket','Ouran High School Host Club','Cardcaptor Sakura','Kimi ni Todoke']},
  {type:'TV',name:'Medical Dramas',items:["Grey's Anatomy",'House MD','ER','Scrubs','The Good Doctor']},
  {type:'TV',name:'2010s Dramas',items:['Breaking Bad','Downton Abbey','Scandal','Homeland','The Americans']},
  {type:'TV',name:'Sitcoms (2000s)',items:['Everybody Loves Raymond','Two and a Half Men','Malcolm in the Middle','My Wife and Kids','According to Jim']},
  {type:'TV',name:'HBO Dramas',items:['The Sopranos','Sex and the City','Six Feet Under','The Wire','Big Love']},
  {type:'TV',name:'Binge-Worthy Dramas',items:['This Is Us','Big Little Lies','Sharp Objects','Ozark','Mare of Easttown']},
  {type:'TV',name:'Reality TV Classics',items:['American Idol','The Bachelor','America\'s Next Top Model','Project Runway','Dancing with the Stars']},
  {type:'TV',name:'Game Shows',items:['Wheel of Fortune','Jeopardy!','Deal or No Deal','Who Wants to Be a Millionaire','The Price Is Right']},
  {type:'TV',name:'Hallmark Movie Plots',items:['City girl returns to small town','Christmas miracle romance','Rivals fall in love','Baker meets chef','Royal falls for commoner']},
  {type:'Music',name:'Taylor Swift Albums',items:['Fearless','1989','Reputation','Folklore','Midnights']},
  {type:'Music',name:'BeyoncÃ© Albums',items:['Lemonade','Dangerously in Love','4','BeyoncÃ© (Self-Titled)','Renaissance']},
  {type:'Music',name:'Olivia Rodrigo Songs',items:['drivers license','good 4 u','brutal','happier','vampire']},
  {type:'Music',name:'Billie Eilish Albums',items:['When We All Fall Asleep...','Happier Than Ever','Hit Me Hard and Soft',"Don't Smile at Me EP",'Guitar Songs EP']},
  {type:'Music',name:'Ariana Grande Albums',items:['Thank U Next','Sweetener','Positions','Yours Truly','My Everything']},
  {type:'Music',name:'Pop Punk Bands',items:['Paramore','My Chemical Romance','Fall Out Boy','Panic! at the Disco','Green Day']},
  {type:'Music',name:'K-Pop Groups',items:['BTS','BLACKPINK','TWICE','Stray Kids','aespa']},
  {type:'Music',name:'90s Pop Stars',items:['Britney Spears','Christina Aguilera','Backstreet Boys','NSYNC','Spice Girls']},
  {type:'Music',name:'Iconic Music Videos',items:['Thriller','Single Ladies','Bad Romance','Wrecking Ball','This Is America']},
  {type:'Music',name:'Alternative Artists',items:['Lorde','Lana Del Rey','Florence + The Machine','Halsey','Mitski']},
  {type:'Music',name:'Sabrina Carpenter Songs',items:['Espresso','Please Please Please','Feather','Nonsense','Skin']},
  {type:'Music',name:'Chappell Roan Songs',items:['Good Luck Babe!','Red Wine Supernova','HOT TO GO!','Casual','Pink Pony Club']},
  {type:'Music',name:'Iconic Girl Bands',items:['Spice Girls',"Destiny's Child",'Little Mix','Fifth Harmony','TLC']},
  {type:'Music',name:'Boy Bands',items:['Backstreet Boys','NSYNC','New Kids on the Block','One Direction','Jonas Brothers']},
  {type:'Music',name:'Adele Songs',items:['Rolling in the Deep','Someone Like You','Hello','Skyfall','Easy On Me']},
  {type:'Music',name:'Katy Perry Songs',items:['Roar','Firework','Dark Horse','California Gurls','Teenage Dream']},
  {type:'Music',name:'Karaoke Night Classics',items:['Total Eclipse of the Heart','Don\'t Stop Believin\'','I Will Survive','Bohemian Rhapsody','Sweet Caroline']},
  {type:'Games',name:'Cozy & Sandbox Games',items:['Minecraft','Stardew Valley','Terraria','Animal Crossing','The Sims 4']},
  {type:'Games',name:'Multiplayer Party Games',items:['Among Us','Fall Guys','Fortnite','Roblox','Valorant']},
  {type:'Games',name:'Indie Story Games',items:['Undertale','Deltarune','Omori','Celeste','Hollow Knight']},
  {type:'Games',name:'Pokemon Games',items:['Pokemon Red','Pokemon Gold','Pokemon Emerald','Pokemon Platinum','Pokemon Sword']},
  {type:'Games',name:'Mario Games',items:['Mario Kart 8','Super Smash Bros Ultimate','Mario Odyssey','Mario Party','Mario Kart Wii']},
  {type:'Games',name:'Legend of Zelda Games',items:['Ocarina of Time','Breath of the Wild',"Majora's Mask",'Tears of the Kingdom','Wind Waker']},
  {type:'Games',name:'Pokemon Generations',items:['Gen 1 (Kanto)','Gen 2 (Johto)','Gen 3 (Hoenn)','Gen 4 (Sinnoh)','Gen 5 (Unova)']},
  {type:'Characters',name:'Hunger Games Characters',items:['Katniss Everdeen','Peeta Mellark','Gale Hawthorne','Lucy Gray Baird','Coriolanus Snow']},
  {type:'Characters',name:'Harry Potter Characters',items:['Harry Potter','Hermione Granger','Ron Weasley','Draco Malfoy','Luna Lovegood']},
  {type:'Characters',name:'Vampire Diaries Characters',items:['Damon Salvatore','Stefan Salvatore','Elena Gilbert','Klaus Mikaelson','Caroline Forbes']},
  {type:'Characters',name:'Stranger Things Characters',items:['Eleven','Mike Wheeler','Dustin Henderson','Max Mayfield','Steve Harrington']},
  {type:'Characters',name:'Bridgerton Characters',items:['Daphne Bridgerton','Simon Basset','Anthony Bridgerton','Kate Sharma','Benedict Bridgerton']},
  {type:'Characters',name:'Encanto Characters',items:['Mirabel Madrigal','Luisa Madrigal','Isabela Madrigal','Camilo Madrigal','Bruno Madrigal']},
  {type:'Characters',name:'Disney Princesses',items:['Cinderella','Ariel','Belle','Jasmine','Mulan']},
  {type:'Characters',name:'Disney Villains',items:['Maleficent','Ursula','Gaston','Jafar','Hades']},
  {type:'Characters',name:'Avatar: The Last Airbender',items:['Aang','Katara','Sokka','Zuko','Toph']},
  {type:'Characters',name:'Friends Characters',items:['Rachel Green','Monica Geller','Phoebe Buffay','Ross Geller','Chandler Bing']},
  {type:'Characters',name:'Twilight Characters',items:['Bella Swan','Edward Cullen','Jacob Black','Alice Cullen','Rosalie Hale']},
  {type:'Characters',name:'Gossip Girl Characters',items:['Blair Waldorf','Serena van der Woodsen','Chuck Bass','Dan Humphrey','Nate Archibald']},
  {type:'Books',name:'Harry Potter Books',items:["Sorcerer's Stone","Chamber of Secrets","Prisoner of Azkaban","Goblet of Fire","Order of the Phoenix"]},
  {type:'Books',name:'Twilight Saga Books',items:['Twilight','New Moon','Eclipse','Breaking Dawn','Midnight Sun']},
  {type:'Books',name:'A Court of Thorns & Roses',items:['A Court of Thorns and Roses','A Court of Mist and Fury','A Court of Wings and Ruin','A Court of Frost and Starlight','A Court of Silver Flames']},
  {type:'Books',name:'Colleen Hoover Books',items:['Verity','It Ends with Us','Ugly Love','Confess','November 9']},
  {type:'Books',name:'Classic YA Books',items:['The Outsiders','The Perks of Being a Wallflower','Looking for Alaska','The Fault in Our Stars','Thirteen Reasons Why']},
  {type:'Books',name:'Beach Read Novels',items:['The Summer I Turned Pretty','Daisy Jones & The Six','Beach Read','The Hating Game','People We Meet on Vacation']},
  {type:'Books',name:'Thriller Novels',items:['Gone Girl','The Girl on the Train','Big Little Lies','Behind Closed Doors','The Silent Patient']},
  {type:'Books',name:'Self-Help Bestsellers',items:['The Secret','You Are a Badass','Girl Wash Your Face','Untamed','Atomic Habits']},
  {type:'Food',name:'Fast Food Chains',items:["McDonald's","Chick-fil-A","Taco Bell","Wendy's","Burger King"]},
  {type:'Food',name:'Ice Cream Flavors',items:['Chocolate','Vanilla','Strawberry','Cookies & Cream','Mint Chip']},
  {type:'Food',name:'Halloween Candies',items:["Reese's","Kit Kat","Twix","Snickers","Candy Corn"]},
  {type:'Food',name:'Starbucks Drinks',items:['Pumpkin Spice Latte','Iced Brown Sugar Oat Latte','Caramel Macchiato','Pink Drink','Matcha Latte']},
  {type:'Food',name:'Boba / Bubble Tea Flavors',items:['Taro','Matcha','Brown Sugar Milk Tea','Mango','Strawberry']},
  {type:'Food',name:'Comfort Foods',items:['Mac and Cheese','Grilled Cheese','Ramen','Chicken Soup','Mashed Potatoes']},
  {type:'Food',name:'Desserts',items:['Chocolate Cake','Cheesecake','Brownies','Cinnamon Rolls','Tiramisu']},
  {type:'Food',name:'Cookie Types',items:['Chocolate Chip','Sugar Cookie','Snickerdoodle','Peanut Butter','Oatmeal Raisin']},
  {type:'Food',name:'International Cuisines',items:['Italian','Mexican','Japanese','Indian','Thai']},
  {type:'Food',name:'Thanksgiving Dishes',items:['Turkey','Stuffing','Mashed Potatoes','Cranberry Sauce','Pumpkin Pie']},
  {type:'Food',name:'Breakfast Foods',items:['Pancakes','Waffles','Avocado Toast','Eggs Benedict','AÃ§aÃ­ Bowl']},
  {type:'Food',name:'Wine Types',items:['Chardonnay','Pinot Grigio','Cabernet Sauvignon','RosÃ©','Moscato']},
  {type:'Food',name:'Cocktail Classics',items:['Margarita','Cosmopolitan','Mojito','Aperol Spritz','PiÃ±a Colada']},
  {type:'Other',name:'Streaming Services',items:['Netflix','Hulu','Disney+','Max','Prime Video']},
  {type:'Other',name:'Social Media',items:['TikTok','Instagram','Twitter/X','Tumblr','YouTube']},
  {type:'Other',name:'Romance Tropes',items:['Enemies to Lovers','Friends to Lovers','Fake Dating','Slow Burn','Second Chance']},
  {type:'Other',name:'Aesthetic Vibes',items:['Cottagecore','Dark Academia','Y2K','Barbiecore','Goblincore']},
  {type:'Other',name:'Love Languages',items:['Words of Affirmation','Quality Time','Physical Touch','Acts of Service','Gift Giving']},
  {type:'Other',name:'Fashion Eras',items:['70s Boho','80s Power Shoulders','90s Grunge','2000s Bratz Doll','2010s Hipster']},
  {type:'Other',name:'Superpowers',items:['Flight','Invisibility','Time Travel','Telepathy','Super Strength']},
  {type:'Other',name:'Fictional Worlds to Live In',items:['Hogwarts','Middle-Earth','Narnia','Panem','Equestria']},
  {type:'Other',name:'Celeb Breakups That Hurt',items:['Brad & Jennifer','Britney & Justin','Selena & Justin','Taylor & Jake','Ryan & Eva']},
  {type:'Other',name:'Icons of the 2000s',items:['Paris Hilton','Britney Spears','Lindsay Lohan','Nicole Richie','Jessica Simpson']},
  {type:'Other',name:'Hallmark Movie Tropes',items:['Christmas Eve deadline','Returns to hometown','Mysterious stranger','Snowed in together','Secret admirer revealed']},
  {type:'Other',name:'Workout Trends',items:['Zumba','Jazzercise','CrossFit','Hot Yoga','Peloton']},
  {type:'MLP',name:'MLP Mane 6',items:['Twilight Sparkle','Rainbow Dash','Fluttershy','Rarity','Applejack']},
  {type:'MLP',name:'MLP Alicorn Princesses',items:['Princess Celestia','Princess Luna','Princess Cadance','Princess Twilight Sparkle','Princess Flurry Heart']},
  {type:'MLP',name:'MLP Villains',items:['Discord','Queen Chrysalis','Nightmare Moon','King Sombra','Tirek']},
  {type:'MLP',name:'MLP Songs',items:['My Little Pony Theme','Winter Wrap Up','This Day Aria',"You'll Play Your Part",'Open Up Your Eyes']},
  {type:'MLP',name:'MLP Seasons',items:['Season 1','Season 2','Season 3','Season 4','Season 5']},
];

var TYPE_EMOJI={
  Movies:'ğŸ¬',TV:'ğŸ“º',Games:'ğŸ®',Characters:'âœ¨',Music:'ğŸµ',Books:'ğŸ“š',Food:'ğŸ•',MLP:'ğŸ¦„',Other:'ğŸŒŸ',Bonus:'ğŸŒ¸',
  'Harry Potter':'âš¡','Sherlock':'ğŸ”','Hannibal':'ğŸ½ï¸','Good Omens':'ğŸ˜‡','Supernatural':'ğŸ‘»',
  Disney:'ğŸ°','Marvel':'ğŸ¦¸','South Park':'ğŸ”ï¸','Emo Music':'ğŸ–¤','Pop Music':'ğŸ’¿',
  '80s Movies':'ğŸ“¼','2000s Movies':'ğŸ’½','Kids Shows':'ğŸ“º','2000s Nostalgia':'âœ¨'
};
var RANK_COLORS=['#ff1493','#ff4da6','#ff69b4','#e0709a','#b06080'];
var AVATARS=['ğŸ¦Š','ğŸ¯','ğŸ»','ğŸ¦','ğŸ¸','ğŸ¦„','ğŸº','ğŸ¦','ğŸ§','ğŸ¦‹','ğŸŒ¸','ğŸ¦©'];
var TROPHIES=['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'];
var BASE_URL='https://acostenbader4-del.github.io/orderupalie/';

var playerId=(function(){
  try{var s=localStorage.getItem('orderup_pid');if(s)return s;}catch(e){}
  var id='p_'+Math.random().toString(36).slice(2,9);
  try{localStorage.setItem('orderup_pid',id);}catch(e){}
  return id;
})();
var roomId=null,isHost=false;
var playerName='',playerSubmitted=false,playerTotalScore=0;
var currentRound=0,currentCategoryIndex=null,usedCatIndexes=[],selectedCatIndex=null;
var activeTypeFilter='All';
var customCategories=[];

function rc(i){return RANK_COLORS[Math.min(i,RANK_COLORS.length-1)];}

function buildTypeTabs(){
  var types=['All'].concat(Object.keys(TYPE_EMOJI));
  var container=document.getElementById('type-tabs');
  container.innerHTML='';
  types.forEach(function(t){
    var div=document.createElement('div');
    div.className='type-tab'+(t===activeTypeFilter?' active':'');
    div.textContent=(t==='All'?'âœ¨ All':(TYPE_EMOJI[t]||'ğŸŒ¸')+' '+t);
    div.onclick=function(){
      activeTypeFilter=t;
      document.querySelectorAll('.type-tab').forEach(function(el){el.classList.remove('active');});
      div.classList.add('active');
      filterCategories();
    };
    container.appendChild(div);
  });
}

function pickRandomCategory(){
  var available=[];
  CATEGORIES.forEach(function(cat,idx){
    if(usedCatIndexes.indexOf(idx)===-1) available.push(idx);
  });
  if(!available.length){showToast('All categories used!',true);return;}
  var btn=document.getElementById('random-btn');
  btn.classList.add('spinning');
  setTimeout(function(){btn.classList.remove('spinning');},600);
  var picked=available[Math.floor(Math.random()*available.length)];
  selectedCatIndex=picked;
  activeTypeFilter='All';
  buildTypeTabs();
  document.getElementById('cat-search-input').value='';
  buildCategoryGrid('');
  setTimeout(function(){
    var sel=document.querySelector('.cat-card.selected');
    if(sel){sel.scrollIntoView({behavior:'smooth',block:'center'});sel.classList.add('flash');}
  },80);
  document.getElementById('start-round-btn').disabled=false;
  showToast('ğŸ² Picked: '+CATEGORIES[picked].name+'!');
}

function initBoard(key,items){
  boards[key]={slots:new Array(items.length).fill(null),selected:null,items:items.slice()};
  renderBoard(key);
}

function renderBoard(key){
  var b=boards[key];
  var slotsEl=document.getElementById(key+'-slots');
  var poolEl=document.getElementById(key+'-pool');
  var poolWrap=document.getElementById(key+'-pool-wrap');
  var n=b.items.length;
  var placed=b.slots.filter(Boolean);
  var inPool=b.items.filter(function(x){return placed.indexOf(x)===-1;});
  slotsEl.innerHTML='';
  for(var i=0;i<n;i++){
    (function(idx){
      var val=b.slots[idx];
      var div=document.createElement('div');
      var c=rc(idx);
      div.className='rank-slot'+(val?' filled':'')+(b.selected!==null?' slot-ready':'');
      div.innerHTML='<span class="slot-num" style="color:'+c+'">'+(idx+1)+'</span>'
        +(val
          ?'<span class="slot-name">'+val+'</span><span class="slot-remove">âœ•</span>'
          :'<span class="slot-empty">'+(b.selected?'â† place here':'empty')+'</span>');
      if(val){
        div.querySelector('.slot-remove').addEventListener('click',function(e){
          e.stopPropagation();b.slots[idx]=null;renderBoard(key);
        });
      }
      div.addEventListener('click',function(){
        if(b.selected!==null){b.slots[idx]=b.selected;b.selected=null;renderBoard(key);}
      });
      slotsEl.appendChild(div);
    })(i);
  }
  poolEl.innerHTML='';
  inPool.forEach(function(item){
    var div=document.createElement('div');
    div.className='pool-item'+(b.selected===item?' sel':'');
    div.textContent=item;
    div.addEventListener('click',function(){
      b.selected=(b.selected===item)?null:item;renderBoard(key);
    });
    poolEl.appendChild(div);
  });
  poolWrap.style.display=inPool.length===0?'none':'';
}

var boards={host:{slots:[],selected:null,items:[]},player:{slots:[],selected:null,items:[]}};
function getBoardOrder(key){return boards[key].slots.slice();}
function isBoardFull(key){return boards[key].slots.every(function(s){return s!==null;});}

function showPage(id){
  document.querySelectorAll('.page').forEach(function(p){p.classList.add('hidden');});
  document.getElementById(id).classList.remove('hidden');
  window.scrollTo(0,0);
}
function showToast(msg,isErr){
  var t=document.getElementById('toast');
  t.textContent=msg;t.style.background=isErr?'#c0392b':'#ff69b4';
  t.classList.add('show');setTimeout(function(){t.classList.remove('show');},2800);
}
function buildStaticList(ulId,items){
  var ul=document.getElementById(ulId);ul.innerHTML='';
  items.forEach(function(item,i){
    var li=document.createElement('li');var c=rc(i);
    li.innerHTML='<div class="stripe" style="background:'+c+'"></div>'
      +'<span class="rnum" style="color:'+c+'">'+(i+1)+'</span>'
      +'<span class="iname">'+item+'</span>';
    ul.appendChild(li);
  });
}
function buildResultList(ulId,playerOrder,hostOrder){
  var ul=document.getElementById(ulId);ul.innerHTML='';
  playerOrder.forEach(function(item,i){
    var li=document.createElement('li');
    var correct=item===hostOrder[i];
    li.classList.add(correct?'correct':'wrong');
    var c=rc(i),hostPos=hostOrder.indexOf(item)+1;
    li.innerHTML='<div class="stripe" style="background:'+c+'"></div>'
      +'<span class="rnum" style="color:'+c+'">'+(i+1)+'</span>'
      +'<span class="iname">'+item+'</span>'
      +(correct?'':'<span class="res-host-pos">Host: #'+hostPos+'</span>')
      +'<span class="res-check">'+(correct?'âœ…':'âŒ')+'</span>';
    ul.appendChild(li);
  });
}
function buildLeaderboard(cId,scored,maxScore,showRound){
  var lb=document.getElementById(cId);lb.innerHTML='';
  scored.forEach(function(p,i){
    var pct=maxScore>0?(showRound?p.score/5:p.total/maxScore)*100:0;
    var isMe=p.id===playerId;
    var div=document.createElement('div');div.className='lb-item';div.style.animationDelay=(i*.1)+'s';
    if(i===0)div.style.borderColor='#ffd700';else if(i===1)div.style.borderColor='#c0c0c0';else if(i===2)div.style.borderColor='#cd7f32';
    if(isMe)div.style.borderColor='var(--pink)';
    var sd=showRound?'<div class="lb-score">'+p.score+'/5</div><div class="lb-sub">total: '+p.total+'</div>':'<div class="lb-score">'+p.total+'</div>';
    div.innerHTML='<div class="lb-pos">'+(i<3?TROPHIES[i]:i+1)+'</div>'
      +'<div style="flex:1"><div class="lb-name">'+p.name+(isMe?' <span style="color:var(--pink);font-size:10px;">(you)</span>':'')+'</div>'
      +'<div class="bar-bg"><div class="bar" style="width:0" data-pct="'+pct+'"></div></div></div>'
      +'<div style="text-align:right;">'+sd+'</div>';
    lb.appendChild(div);
  });
  setTimeout(function(){document.querySelectorAll('.bar').forEach(function(b){b.style.width=b.dataset.pct+'%';});},300);
}

function toggleJoinBox(){
  var box=document.getElementById('join-box');box.classList.toggle('hidden');
  if(!box.classList.contains('hidden'))setTimeout(function(){document.getElementById('join-code').focus();},50);
}
function joinAndGo(){
  var code=document.getElementById('join-code').value.replace(/\s/g,'').toUpperCase();
  if(!code){showToast('Enter a room code!',true);return;}
  roomId=code;showPage('name-screen');
  setTimeout(function(){document.getElementById('player-name-input').focus();},50);
}

function goHost(){
  isHost=true;roomId=Math.random().toString(36).slice(2,8).toUpperCase();
  db.ref('rooms/'+roomId).set({status:'lobby',currentRound:0,hostOrder:null,revealed:false,categoryIndex:null,usedCats:[],finalResults:false})
    .then(setupHostLobby).catch(function(e){showToast('Firebase error: '+e.message,true);});
}
function setupHostLobby(){
  showPage('host-lobby');
  document.getElementById('room-code-display').textContent=roomId;
  var joinUrl=BASE_URL+'?join='+roomId;
  document.getElementById('join-url-text').textContent=joinUrl;
  document.getElementById('qr-inner').innerHTML='';
  new QRCode(document.getElementById('qr-inner'),{text:joinUrl,width:170,height:170,colorDark:'#000',colorLight:'#fff'});
  db.ref('rooms/'+roomId+'/players').on('value',function(snap){
    var players=snap.val()||{},entries=Object.entries(players);
    document.getElementById('pcnt').textContent=entries.length+' player'+(entries.length!==1?'s':'');
    var list=document.getElementById('player-list');
    if(!entries.length){list.innerHTML='<div class="no-players">Waiting for playersâ€¦</div>';return;}
    list.innerHTML='';
    entries.forEach(function(e,i){
      var div=document.createElement('div');div.className='player-item';
      div.innerHTML='<div class="p-avatar">'+AVATARS[i%AVATARS.length]+'</div>'
        +'<span class="p-name">'+(e[1].name||e[0])+'</span>'
        +'<span class="p-score">'+(e[1].totalScore||0)+' pts</span>'
        +'<div class="pulse-dot"></div>';
      list.appendChild(div);
    });
    document.getElementById('rounds-summary').textContent=currentRound>0?'Completed '+currentRound+' round'+(currentRound!==1?'s':'')+' so far':'';
  });
}
function goPickCategory(){
  db.ref('rooms/'+roomId+'/usedCats').once('value').then(function(snap){
    usedCatIndexes=snap.val()||[];selectedCatIndex=null;
    activeTypeFilter='All';
    document.getElementById('start-round-btn').disabled=true;
    document.getElementById('cat-search-input').value='';
    document.getElementById('pick-round-label').textContent='Round '+(currentRound+1);
    buildTypeTabs();
    buildCategoryGrid('');
    showPage('host-pick-screen');
  });
}
function buildCategoryGrid(filter){
  var grid=document.getElementById('cat-grid');grid.innerHTML='';var f=filter.toLowerCase();
  var shown=0;
  CATEGORIES.forEach(function(cat,idx){
    if(activeTypeFilter!=='All'&&cat.type!==activeTypeFilter)return;
    var searchStr=(cat.type+' '+cat.name+' '+cat.items.join(' ')).toLowerCase();
    if(f&&searchStr.indexOf(f)===-1)return;
    shown++;
    var used=usedCatIndexes.indexOf(idx)!==-1;
    var div=document.createElement('div');
    var isCustom=cat.isCustom||false;
    div.className='cat-card'+(used?' used':'')+(selectedCatIndex===idx?' selected':'')+(isCustom?' custom-cat-card':'');
    div.innerHTML='<div class="cat-type">'+(TYPE_EMOJI[cat.type]||'ğŸŒ¸')+' '+cat.type+(isCustom?' <span style="font-size:9px;background:rgba(168,85,247,0.2);border-radius:4px;padding:1px 5px;margin-left:3px;">CUSTOM</span>':'')+'</div>'
      +'<div class="cat-name">'+cat.name+'</div>'
      +'<div class="cat-items">'+cat.items.join(' Â· ')+'</div>';
    if(!used)div.onclick=function(){
      selectedCatIndex=idx;
      document.querySelectorAll('.cat-card').forEach(function(c){c.classList.remove('selected');});
      div.classList.add('selected');document.getElementById('start-round-btn').disabled=false;
    };
    grid.appendChild(div);
  });
  var avail=CATEGORIES.filter(function(_,i){return usedCatIndexes.indexOf(i)===-1;}).length;
  document.getElementById('cat-count-display').textContent=shown+' shown Â· '+avail+' available';
}
function filterCategories(){buildCategoryGrid(document.getElementById('cat-search-input').value);}
function startRound(){
  if(selectedCatIndex===null)return;
  currentCategoryIndex=selectedCatIndex;currentRound++;
  var newUsed=usedCatIndexes.concat([selectedCatIndex]);
  var cat=CATEGORIES[currentCategoryIndex];
  var isCustom=cat.isCustom||false;
  db.ref('rooms/'+roomId+'/players').once('value').then(function(snap){
    var players=snap.val()||{},updates={};
    Object.keys(players).forEach(function(pid){updates['rooms/'+roomId+'/players/'+pid+'/order']=null;});
    updates['rooms/'+roomId+'/status']='playing';
    updates['rooms/'+roomId+'/currentRound']=currentRound;
    updates['rooms/'+roomId+'/categoryIndex']=currentCategoryIndex;
    updates['rooms/'+roomId+'/customCat']=isCustom?{type:cat.type,name:cat.name,items:cat.items}:null;
    updates['rooms/'+roomId+'/hostOrder']=null;
    updates['rooms/'+roomId+'/revealed']=false;
    updates['rooms/'+roomId+'/finalResults']=false;
    updates['rooms/'+roomId+'/usedCats']=newUsed;
    db.ref().update(updates).then(function(){
      showPage('host-game-screen');
      document.getElementById('host-round-badge').textContent='Round '+currentRound;
      document.getElementById('host-cat-label').textContent=(TYPE_EMOJI[cat.type]||'ğŸŒ¸')+' '+cat.name;
      document.getElementById('lock-btn').disabled=false;
      document.getElementById('lock-msg').textContent='';
      document.getElementById('reveal-wrap').classList.add('hidden');
      initBoard('host',cat.items.slice());
    }).catch(function(e){showToast('Error: '+e.message,true);});
  });
}
function lockHostOrder(){
  if(!isBoardFull('host')){showToast('Place all 5 items in the slots first! ğŸ‘†',true);return;}
  var order=getBoardOrder('host');
  db.ref('rooms/'+roomId+'/hostOrder').set(order).then(function(){
    document.getElementById('lock-btn').disabled=true;
    document.getElementById('lock-msg').textContent='âœ… Locked! Waiting for players to submitâ€¦';
    document.getElementById('reveal-wrap').classList.remove('hidden');
    showToast('Order locked! ğŸ”’');
    db.ref('rooms/'+roomId+'/players').on('value',function(snap){
      var players=snap.val()||{},entries=Object.entries(players);
      var prog=document.getElementById('players-progress-host');prog.innerHTML='';
      entries.forEach(function(e){
        var div=document.createElement('div');div.className='pp-item';
        var sub=e[1].order&&e[1].order.length>0;
        div.innerHTML='<span>'+AVATARS[0]+'</span><span>'+(e[1].name||e[0])+'</span>'
          +(sub?'<span class="pp-submitted">âœ… Submitted</span>':'<span class="pp-waiting">â³ Rankingâ€¦</span>');
        prog.appendChild(div);
      });
    });
  }).catch(function(e){showToast('Error: '+e.message,true);});
}
function revealRound(){
  db.ref('rooms/'+roomId).update({revealed:true,status:'roundEnd'}).then(showRoundResults);
}

function confirmName(){
  var n=document.getElementById('player-name-input').value.trim();
  if(!n){showToast('Enter a nickname!',true);return;}
  playerName=n;
  db.ref('rooms/'+roomId+'/players/'+playerId).once('value').then(function(snap){
    var existing=snap.val();
    if(existing&&existing.name){
      playerTotalScore=existing.totalScore||0;
      playerName=n;
      return db.ref('rooms/'+roomId+'/players/'+playerId).update({name:playerName});
    } else {
      return db.ref('rooms/'+roomId+'/players/'+playerId).set({name:playerName,order:null,totalScore:0});
    }
  }).then(function(){
    document.getElementById('wait-code').textContent=roomId;
    db.ref('rooms/'+roomId).once('value').then(function(snap){
      var data=snap.val()||{};
      currentRound=data.currentRound||0;
      document.getElementById('wait-pts').textContent=playerTotalScore>0?'â­ Your total: '+playerTotalScore+' pts':'';
      if(data.status==='roundEnd'){
        setupPlayerListeners();showRoundResults();
      } else if(data.status==='playing'){
        setupPlayerListeners();
        currentCategoryIndex=data.categoryIndex;
        showPlayerGame(data);
      } else {
        showPage('waiting-screen');setupPlayerListeners();
      }
    });
  }).catch(function(e){showToast('Could not join: '+e.message+' â€” fix Firebase rules!',true);});
}
function setupPlayerListeners(){
  db.ref('rooms/'+roomId+'/status').on('value',function(snap){
    var status=snap.val();
    if(status==='playing'){
      playerSubmitted=false;
      db.ref('rooms/'+roomId).once('value').then(function(rs){
        var data=rs.val();if(!data)return;
        currentRound=data.currentRound||1;currentCategoryIndex=data.categoryIndex;
        showPlayerGame(data);
      });
    }
    if(status==='roundEnd'){var cur=document.querySelector('.page:not(.hidden)');if(!cur||cur.id!=='round-results-screen')showRoundResults();}
    if(status==='lobby'){
      document.getElementById('wait-info').textContent='Waiting for next roundâ€¦';
      document.getElementById('wait-pts').textContent=playerTotalScore>0?'â­ Your total: '+playerTotalScore+' pts':'';
      showPage('waiting-screen');
    }
  });
  db.ref('rooms/'+roomId+'/revealed').on('value',function(snap){if(snap.val()===true)showRoundResults();});
  db.ref('rooms/'+roomId+'/finalResults').on('value',function(snap){if(snap.val()===true)showFinalResults();});
}
function showPlayerGame(data){
  var cat=CATEGORIES[data.categoryIndex]||data.customCat;
  if(!cat)return;
  if(data.customCat&&!CATEGORIES[data.categoryIndex]){
    CATEGORIES[data.categoryIndex]=data.customCat;
  }
  document.getElementById('player-round-badge').textContent='Round '+(data.currentRound||1);
  document.getElementById('player-pts-badge').textContent=playerTotalScore>0?playerTotalScore+' pts':'';
  document.getElementById('player-cat-label').textContent=(TYPE_EMOJI[cat.type]||'ğŸŒ¸')+' '+cat.name;
  showPage('player-game-screen');
  var shuffled=cat.items.slice().sort(function(){return Math.random()-.5;});
  initBoard('player',shuffled);
  document.getElementById('submit-btn').classList.remove('hidden');
  document.getElementById('sub-banner').classList.add('hidden');
}
function submitOrder(){
  if(playerSubmitted){showToast('Already submitted!');return;}
  if(!isBoardFull('player')){showToast('Place all 5 items in the slots first! ğŸ‘†',true);return;}
  var order=getBoardOrder('player');
  db.ref('rooms/'+roomId+'/players/'+playerId+'/order').set(order).then(function(){
    playerSubmitted=true;
    document.getElementById('submit-btn').classList.add('hidden');
    document.getElementById('sub-banner').classList.remove('hidden');
    showToast('Submitted! ğŸŒ¸');
  }).catch(function(e){showToast('Submit failed: '+e.message,true);});
}

function showRoundResults(){
  db.ref('rooms/'+roomId).once('value').then(function(snap){
    var data=snap.val();if(!data||!data.hostOrder)return;
    var hostOrder=data.hostOrder,players=data.players||{},cat=CATEGORIES[data.categoryIndex]||data.customCat||{};
    currentRound=data.currentRound||currentRound;
    var scored=Object.entries(players).map(function(e){
      var id=e[0],p=e[1],score=0;
      if(p.order)p.order.forEach(function(item,i){if(item===hostOrder[i])score++;});
      return{id:id,name:p.name||id,score:score,total:(p.totalScore||0)+score};
    }).sort(function(a,b){return b.score-a.score;});
    var updates={};scored.forEach(function(p){updates['rooms/'+roomId+'/players/'+p.id+'/totalScore']=p.total;});
    db.ref().update(updates);
    var myEntry=scored.find(function(s){return s.id===playerId;});
    if(myEntry)playerTotalScore=myEntry.total;
    showPage('round-results-screen');
    document.getElementById('rr-title').textContent='Round '+currentRound+' Results';
    document.getElementById('rr-cat-label').textContent=(TYPE_EMOJI[cat.type]||'ğŸŒ¸')+' '+(cat.name||'');
    buildStaticList('rr-host-list',hostOrder);
    var myP=players[playerId];
    if(myP&&myP.order&&!isHost){
      document.getElementById('player-own-results').classList.remove('hidden');
      document.getElementById('rr-your-score').textContent=(myEntry?myEntry.score:0)+'/5';
      buildResultList('player-result-list',myP.order,hostOrder);
    }else{document.getElementById('player-own-results').classList.add('hidden');}
    buildLeaderboard('rr-lb-list',scored,5,true);
    var btns=document.getElementById('rr-buttons');btns.innerHTML='';
    if(isHost){
      var nb=document.createElement('button');nb.className='btn btn-primary';nb.textContent='Next Round â†’';nb.onclick=goPickCategory;btns.appendChild(nb);
      var eb=document.createElement('button');eb.className='btn btn-outline';eb.textContent='End Game & See Final Results';
      eb.onclick=function(){db.ref('rooms/'+roomId+'/finalResults').set(true).then(showFinalResults);};btns.appendChild(eb);
    }else{
      var p=document.createElement('p');p.style.cssText='color:var(--muted);font-size:12px;';p.textContent='â³ Waiting for host to start next roundâ€¦';btns.appendChild(p);
    }
  });
}

function showFinalResults(){
  db.ref('rooms/'+roomId+'/players').once('value').then(function(snap){
    var players=snap.val()||{};
    var scored=Object.entries(players).map(function(e){return{id:e[0],name:e[1].name||e[0],total:e[1].totalScore||0};}).sort(function(a,b){return b.total-a.total;});
    showPage('final-results-screen');
    if(scored.length>0){
      document.getElementById('winner-name').textContent=scored[0].name;
      document.getElementById('winner-pts').textContent=scored[0].total+' total points across '+currentRound+' round'+(currentRound!==1?'s':'');
    }
    buildLeaderboard('final-lb-list',scored,scored.length>0?scored[0].total:1,false);
  });
}

function skipRound(){
  if(!confirm('Skip this round? Players will go back to waiting and you\'ll pick a new category.'))return;
  currentRound=Math.max(0,currentRound-1);
  db.ref('rooms/'+roomId).update({
    status:'lobby',
    hostOrder:null,
    revealed:false,
    categoryIndex:null
  }).then(function(){
    db.ref('rooms/'+roomId+'/usedCats').once('value').then(function(snap){
      var used=snap.val()||[];
      var filtered=used.filter(function(i){return i!==currentCategoryIndex;});
      db.ref('rooms/'+roomId+'/usedCats').set(filtered).then(function(){
        showToast('Round skipped! Pick a new category ğŸ²');
        goPickCategory();
      });
    });
  });
}

function openCustomModal(){
  document.getElementById('custom-cat-name').value='';
  document.querySelectorAll('.custom-item-input').forEach(function(inp){inp.value='';});
  document.getElementById('custom-cat-modal').classList.remove('hidden');
  setTimeout(function(){document.getElementById('custom-cat-name').focus();},100);
}
function closeCustomModal(){
  document.getElementById('custom-cat-modal').classList.add('hidden');
}
function saveCustomCategory(){
  var name=document.getElementById('custom-cat-name').value.trim();
  if(!name){showToast('Give your category a name!',true);return;}
  var items=[];
  document.querySelectorAll('.custom-item-input').forEach(function(inp){
    var v=inp.value.trim();if(v)items.push(v);
  });
  if(items.length<5){showToast('Fill in all 5 items!',true);return;}
  var newCat={type:'Custom',name:name,items:items.slice(0,5),isCustom:true};
  CATEGORIES.push(newCat);
  customCategories.push(newCat);
  selectedCatIndex=CATEGORIES.length-1;
  TYPE_EMOJI['Custom']='âœï¸';
  closeCustomModal();
  activeTypeFilter='All';
  buildTypeTabs();
  buildCategoryGrid('');
  setTimeout(function(){
    var sel=document.querySelector('.cat-card.selected');
    if(sel){sel.scrollIntoView({behavior:'smooth',block:'center'});sel.classList.add('flash');}
  },80);
  document.getElementById('start-round-btn').disabled=false;
  showToast('âœï¸ Custom category "'+name+'" added!');
}
document.getElementById('custom-cat-modal').addEventListener('click',function(e){
  if(e.target===this)closeCustomModal();
});
document.getElementById('custom-cat-modal').addEventListener('keydown',function(e){
  if(e.key==='Escape')closeCustomModal();
  if(e.key==='Enter'){
    var inputs=Array.from(document.querySelectorAll('.custom-item-input'));
    var all=inputs.every(function(i){return i.value.trim();});
    if(all&&document.getElementById('custom-cat-name').value.trim())saveCustomCategory();
  }
});

var urlCode=new URLSearchParams(location.search).get('join');
if(urlCode){
  roomId=urlCode.toUpperCase();
  document.getElementById('join-code').value=roomId;
  document.getElementById('join-box').classList.remove('hidden');
  showPage('name-screen');
  setTimeout(function(){document.getElementById('player-name-input').focus();},50);
}
</script>
</body>
</html>
